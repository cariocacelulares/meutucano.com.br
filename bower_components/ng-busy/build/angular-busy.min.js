/*** An AngularJS module for reacting to when your app is busy.
* @author Mike Grabski <me@mikegrabski.com>
* @version v0.2.0
* @link https://github.com/HackedByChinese/ng-busy.git
* @license MIT
*/
!function(a,b){"use strict";b.module("ngBusy.interceptor",[]).provider("busyInterceptor",function(){this.$get=["$rootScope","$q",function(a,b){function c(){e=f=0}function d(b){b.config.notBusy||(a.$broadcast("busy.end",{url:b.config.url,name:b.config.name,remaining:e-++f}),f>=e&&c())}var e=0,f=0;return{outstanding:function(){return e-f},request:function(c){return c.notBusy||(a.$broadcast("busy.begin",{url:c.url,name:c.name}),e++),c||b.when(c)},response:function(a){return d(a),a},responseError:function(a){return d(a),b.reject(a)}}}]}).config(["$httpProvider",function(a){a.interceptors.push("busyInterceptor")}]),b.module("ngBusy.busy",[]).directive("busy",["$parse","$timeout",function(a,c){return{restrict:"A",tranclude:!0,scope:{},controller:["$scope",function(a){this.setBusyMessageElement=function(b){a.busyMessageElement=b}}],link:function(d,e,f){f.$observe("busy",function(a){d.busyMessage=a}),f.$observe("busyWhenUrl",function(a){d.busyWhenUrl=a}),f.$observe("busyWhenName",function(a){d.busyWhenName=a}),f.$observe("busyAddClasses",function(a){d.busyAddClasses=a}),f.$observe("busyRemoveClasses",function(a){d.busyRemoveClasses=a}),f.$observe("busyDisabled",function(c){var e=a(c)(d);d.busyDisabled=b.isDefined(e)?e:!0}),f.$observe("notBusyWhenUrl",function(a){d.notBusyWhenUrl=a}),f.$observe("notBusyWhenName",function(a){d.notBusyWhenName=a}),f.$observe("notBusyAddClasses",function(a){d.notBusyAddClasses=a}),f.$observe("notBusyRemoveClasses",function(a){d.notBusyRemoveClasses=a}),f.$observe("notBusyDisabled",function(c){var e=a(c)(d);d.notBusyDisabled=b.isDefined(e)?e:!1}),d.isBusyFor=function(a,b){var c;return d[c=b?"busyWhenName":"notBusyWhenName"]?!!a.name&&!!a.name.match(d[c]):d[c=b?"busyWhenUrl":"notBusyWhenUrl"]?!!a.url&&!!a.url.match(d[c]):b===!0||a.remaining<=0},d.$on("busy.begin",function(a,b){if(!d.busy&&d.isBusyFor(b,!0)){d.originalContent=e.html(),d.busyDisabled&&c(function(){e.attr("disabled",!0)});var f=d.busyMessageElement?d.busyMessageElement.clone():null;(f||d.busyMessage)&&e.html("").append(f||d.busyMessage),e.removeClass(d.busyRemoveClasses).addClass(d.busyAddClasses),d.busy=!0}}),d.$on("busy.end",function(a,b){d.busy&&d.isBusyFor(b)&&(d.originalContent&&e.html(d.originalContent),e.attr("disabled",d.notBusyDisabled===!0),e.removeClass(d.notBusyRemoveClasses).addClass(d.notBusyAddClasses),d.busy=!1)})}}}]).directive("busyMessage",function(){return{restrict:"AE",transclude:!0,require:"^busy",template:"",replace:!0,compile:function(a,b,c){return function(a,b,d,e){e.setBusyMessageElement(c(a,function(){}))}}}}),b.module("ngBusy",["ngBusy.interceptor","ngBusy.busy"])}(window,window.angular);
//# sourceMappingURL=angular-busy.map