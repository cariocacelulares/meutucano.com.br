<div class="overlay" ng-controller="SearchController as Search">
    <div class="overlay-content has-results m-t-20">
        <div class="container-fluid">
            <img class="overlay-brand" src="assets/img/logo-image.png" alt="logo">
            <a ng-click="Search.close()" class="close-icon-light overlay-close text-black fs-16">
                <i class="fa fa-remove"></i>
            </a>
        </div>
        <div class="container-fluid">
            <form id="search">
                <input ng-close="Search.close()" type="text" ng-model="Search.search" ng-model-options="{debounce: 1000}" ng-change="Search.load()" id="searchInput" class="no-border overlay-search bg-transparent" placeholder="Buscar...">
            </form>
        </div>
        <div class="container-fluid">
            <div class="search-results m-t-40">
                <div ng-if="Search.buscaLoading" class="progress-circle-indeterminate m-t-45" style="display: block;"></div>
                <div class="row" ng-if="!Search.buscaLoading && Search.search.length > 3">
                    <p class="hint-text m-l-15" ng-if="!Search.resultadoBusca.length">Nenhum pedido ou nota fiscal encontrada.</p>
                    <div ng-class="{'clear-l': ($index % 3) === 0}" class="col-md-4" ng-repeat="pedido in Search.resultadoBusca">
                        <div class="panel panel-default">
                            <div class="panel-body">
                                <div class="row">
                                    <div class="col-md-9">
                                        <span class="small hint-text b-r b-grey p-r-10 m-r-5" ng-bind="pedido.marketplace"></span>
                                        <span class="small hint-text b-r b-grey p-r-10 m-r-5" ng-bind-html="pedido.nota.numero | highlight:Search.search"></span>
                                        <span class="small hint-text" ng-bind="pedido.created_at"></span><br>
                                        <span class="small m-t-10 hint-text inline-block"><span ng-bind-html="(pedido.codigo_marketplace || 'Sem código') | highlight:Search.search"></span></span>
                                        <span class="fs-12 bold ellipsis" ng-bind-html="pedido.cliente.nome | highlight:Search.search"></span>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="dropdown pull-right">
                                            <button class="btn btn-info dropdown-toggle" type="button">
                                                <i class="fa fa-cog"></i>&nbsp;
                                                <span class="caret"></span>
                                            </button>
                                            <ul class="dropdown-menu">
                                                <li>
                                                    <a ng-click="App.cancelar(pedido.id)"><i class="fa fa-trash-o"></i>&nbsp; Cancelar</a>
                                                </li>
                                                <li>
                                                    <a ng-click="App.email(pedido.id, pedido.cliente.email)"><i class="fa fa-envelope-o"></i>&nbsp; E-mail</a>
                                                </li>
                                                <li>
                                                    <a ng-click="App.printXML(pedido.id)"><i class="fa fa-file-code-o"></i>&nbsp; XML</a>
                                                </li>
                                                <li>
                                                    <a ng-click="App.printDanfe(pedido.id)"><i class="fa fa-file-pdf-o"></i>&nbsp; DANFE</a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                                <div class="m-t-15 p-t-15 b-t b-grey" ng-repeat="rastreio in pedido.rastreios">
                                    <div class="row">
                                        <div class="col-md-9">
                                            <span class="small hint-text b-r b-grey p-r-10 m-r-5" ng-bind="rastreio.servico"></span>
                                            <span class="small hint-text b-r b-grey p-r-10 m-r-5" ng-bind-html="(rastreio.prazo + ' dias') | highlight:Search.search"></span>
                                            <span class="small hint-text" ng-bind="rastreio.data_envio_readable"></span><br>
                                            <a class="fs-12 bold ellipsis m-t-15" target="_blank" ng-href="http://websro.correios.com.br/sro_bin/txect01$.Inexistente?P_LINGUA=001&P_TIPO=002&P_COD_LIS={{ rastreio.rastreio }}" ng-bind-html="rastreio.rastreio | highlight:Search.search"></a>
                                            <div ng-class="{
                                            'alert-danger': rastreio.status == 3 || rastreio.status == 5 || rastreio.status == 6,
                                            'alert-warning': rastreio.status == 2,
                                            'alert-success': rastreio.status == 4,
                                            'alert-info': rastreio.status == 1 || rastreio.status == 7 || rastreio.status == 8
                                            }" class="alert m-b-0 m-t-10" style="width: 120px">
                                                <strong ng-bind="rastreio.status_description"></strong>
                                            </div>
                                            <div class="small hint-text p-r-10 m-r-5 m-t-10" ng-if="rastreio.rastreio_ref">
                                                Reenvio de: <span ng-bind="rastreio.rastreio_ref.rastreio"></span>
                                            </div>
                                            <div class="small hint-text p-r-10 m-r-5 m-t-10" ng-if="rastreio.pi">
                                                <span ng-bind="rastreio.pi.status_description"></span><br>
                                                PI <strong ng-bind="rastreio.pi.codigo_pi"></strong> aberta em <strong ng-bind="rastreio.pi.created_at"></strong>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="dropdown pull-right">
                                                <button class="btn btn-info dropdown-toggle" type="button">
                                                    <i class="fa fa-cog"></i>&nbsp;
                                                    <span class="caret"></span>
                                                </button>
                                                <ul class="dropdown-menu">
                                                    <li>
                                                        <a title="Editar" ng-click="App.editar(rastreio)"><i class="fa fa-edit"></i>&nbsp; Editar</a>
                                                    </li>
                                                    <li>
                                                        <a title="Observação" ng-click="App.observacao(rastreio)"><i class="fa fa-comment"></i>&nbsp; Observação</a>
                                                    </li>
                                                    <li>
                                                        <a title="Devolução" ng-click="App.devolucao(rastreio)"><i class="fa fa-undo"></i>&nbsp; Devolução</a>
                                                    </li>
                                                    <li>
                                                        <a title="Logística reversa" ng-click="App.logistica(rastreio)"><i class="fa fa-exchange"></i>&nbsp; Logística</a>
                                                    </li>
                                                    <li>
                                                        <a title="Pedido de informação" ng-click="App.pi(rastreio)"><i class="fa fa-exclamation-triangle"></i>&nbsp; PI</a>
                                                    </li>
                                                    <li>
                                                        <a title="Imprimir etiqueta" ng-click="App.printEtiqueta(rastreio.id)"><i class="fa fa-tag"></i>&nbsp; Etiqueta</a>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="m-t-15 p-t-15 b-t b-grey">
                                        <button ng-if="rastreio.observacao" ng-click="App.observacao(rastreio)" class="btn btn-default btn-xs">
                                            <i class="fa fa-comment"></i>&nbsp; Obs
                                        </button>
                                        <button ng-if="rastreio.devolucao" ng-click="App.devolucao(rastreio)" class="btn btn-default btn-xs">
                                            <i class="fa fa-undo"></i>&nbsp; Devolução
                                        </button>
                                        <button ng-if="rastreio.logistica" ng-click="App.logistica(rastreio)" class="btn btn-default btn-xs">
                                            <i class="fa fa-exchange"></i>&nbsp; Logística
                                        </button>
                                        <button ng-if="rastreio.pi" ng-click="App.pi(rastreio)" class="btn btn-default btn-xs">
                                            <i class="fa fa-warning"></i>&nbsp; PI
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
