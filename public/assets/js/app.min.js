!function(){"use strict";angular.module("MeuTucano",["ui.router","satellizer","restangular","focusIt","ngBusy","toaster","ngAnimate","jcs-autoValidate","ngFileUpload","ngImgCrop","angular-loading-bar","ngDialog","mp.datePicker","ui.utils.masks","angular-clipboard","ngStorage","ngTagsInput","oitozero.ngSweetAlert","720kb.tooltips","highcharts-ng","as.sortable","ngSanitize","ui.select"])}(),function(){"use strict";angular.module("MeuTucano").config(["envServiceProvider",function(envServiceProvider){envServiceProvider.config({domains:{development:["tucano.app"],production:["192.168.2.170"],aws:["www.meutucano.com.br","meutucano.com.br"]},vars:{development:{apiUrl:"http://tucano.app/api",assetUrl:"http://tucano.app/"},production:{apiUrl:"http://192.168.2.170/meutucano/public/index.php/api",assetUrl:"http://192.168.2.170/meutucano/public/"},aws:{apiUrl:"https://www.meutucano.com.br/index.php/api",assetUrl:"https://meutucano.s3-sa-east-1.amazonaws.com/public/"}}}),envServiceProvider.check()}]).config(["$authProvider","envServiceProvider",function($authProvider,envServiceProvider){$authProvider.loginUrl=envServiceProvider.read("apiUrl")+"/authenticate"}]).config(["$animateProvider",function($animateProvider){$animateProvider.classNameFilter(/^((?!(fa-spin)).)*$/)}]).run(["$anchorScroll","$rootScope","$state",function($anchorScroll,$rootScope,$state){$anchorScroll.yOffset=70,$rootScope.$on("$stateChangeStart",function(event,toState){var user=JSON.parse(localStorage.getItem("user"));user?($rootScope.authenticated=!0,$rootScope.currentUser=user,"login"===toState.name&&(event.preventDefault(),$state.go("app.dashboard"))):user||"login"===toState.name||(event.preventDefault(),$state.go("login"))})}]).config(["RestangularProvider","envServiceProvider",function(RestangularProvider,envServiceProvider){RestangularProvider.setBaseUrl(envServiceProvider.read("apiUrl")),RestangularProvider.setResponseExtractor(function(response){return response.data}),RestangularProvider.setDefaultHeaders({Authorization:"Bearer "+localStorage.getItem("satellizer_token")})}]).run(["Restangular","$http","$state","envService","toaster",function(Restangular,$http,$state,envService,toaster){Restangular.setErrorInterceptor(function(response,deferred,responseHandler){return 401===response.status?($http.get(envService.read("apiUrl")+"/token",{headers:{Authorization:"Bearer "+localStorage.getItem("satellizer_token")}}).error(function(){localStorage.removeItem("user"),$state.go("login")}).then(function(tokenResponse){localStorage.setItem("satellizer_token",tokenResponse.data.token),$http(response.config).then(responseHandler,deferred.reject)}),!1):([400].indexOf(response.status)>=0?(localStorage.removeItem("user"),$state.go("login")):[403].indexOf(response.status)>=0?toaster.pop("error","Acesso negado","Você não possui acesso para concluir essa ação, contate o administrador!"):response.data.msg?toaster.pop("error","Erro",response.data.msg):toaster.pop("error","Erro","Não foi possível processar a operação, contate o administrador!"),!0)})}]).config(["$httpProvider",function($httpProvider){$httpProvider.interceptors.push("ToasterInterceptor")}]).run(["$rootScope","$state",function($rootScope,$state){$rootScope.$on("$stateChangeStart",function(event,toState){if(toState.data&&toState.data.roles){var block=!0;angular.forEach(toState.data.roles,function(role){"undefined"!=typeof $rootScope.currentUser&&_.find($rootScope.currentUser.roles,{name:role})&&(block=!1)}),block&&(event.preventDefault(),$state.go("app.dashboard"))}return!0})}])}(),function(){"use strict";angular.module("MeuTucano").config(["$stateProvider","$urlRouterProvider",function($stateProvider,$urlRouterProvider){$urlRouterProvider.otherwise("/login"),$stateProvider.state("login",{url:"/login",templateUrl:"views/login.html",controller:"AuthController as Auth"}).state("app",{url:"/app",templateUrl:"views/layouts/app.html",controller:"AppController as App"}).state("app.dashboard",{url:"/dashboard",templateUrl:"views/dashboard.html",controller:"DashboardController as Dashboard"}).state("app.rastreios",{url:"/rastreios",templateUrl:"views/layouts/default.html",data:{roles:["admin","atendimento"]}}).state("app.rastreios.monitorados",{url:"/monitorados",templateUrl:"views/rastreio/monitorado/list.html",controller:"RastreioMonitoradoListController as RastreioMonitoradoList"}).state("app.rastreios.importantes",{url:"/importantes",templateUrl:"views/rastreio/importante/list.html",controller:"RastreioImportanteListController as RastreioImportanteList"}).state("app.rastreios.pis",{url:"/pis",templateUrl:"views/layouts/default.html"}).state("app.rastreios.pis.pendentes",{url:"/pendentes",templateUrl:"views/rastreio/pi/pendente/list.html",controller:"PiPendenteListController as PiPendenteList"}).state("app.rastreios.devolucoes",{url:"/devolucoes",templateUrl:"views/rastreio/devolucao/pendente/list.html",controller:"DevolucaoPendenteListController as DevolucaoList"}).state("app.faturamento",{url:"/faturamento",templateUrl:"views/layouts/default.html",data:{roles:["admin","faturamento"]}}).state("app.faturamento.index",{url:"/list",templateUrl:"views/faturamento/list.html",controller:"FaturamentoListController as FaturamentoList"}).state("app.faturamento.notas",{url:"/notas",templateUrl:"views/faturamento/notas.html",controller:"FaturamentoController as Faturamento"}).state("app.admin",{url:"/admin",templateUrl:"views/layouts/default.html",data:{roles:["admin"]}}).state("app.admin.icms",{url:"/icms",templateUrl:"views/admin/icms.html",controller:"IcmsController as Icms"}).state("app.pedidos",{url:"/pedidos",templateUrl:"views/layouts/default.html",data:{roles:["admin","gestor","atendimento","faturamento"]}}).state("app.pedidos.index",{url:"/list",templateUrl:"views/pedido/list.html",controller:"PedidoListController as PedidoList"}).state("app.pedidos.detalhe",{url:"/{id}",templateUrl:"views/pedido/detalhe.html",controller:"PedidoDetalheController as PedidoDetalhe"}).state("app.clientes",{url:"/clientes",templateUrl:"views/layouts/default.html",roles:["admin","gestor"]}).state("app.clientes.index",{url:"/list",templateUrl:"views/cliente/list.html",controller:"ClienteListController as ClienteList"}).state("app.clientes.detalhe",{url:"/{id}",templateUrl:"views/cliente/detalhe.html",controller:"ClienteDetalheController as ClienteDetalhe"}).state("app.interno",{url:"/interno",templateUrl:"views/layouts/default.html"}).state("app.interno.usuarios",{url:"/usuarios",templateUrl:"views/layouts/default.html"}).state("app.interno.usuarios.index",{url:"/list",templateUrl:"views/usuario/list.html",controller:"UsuarioListController as UsuarioList",data:{roles:["admin"]}}).state("app.interno.usuarios.senhas",{url:"/{id}/senhas",templateUrl:"views/usuario/senha/list.html",controller:"SenhaListController as SenhaList"}).state("app.interno.senhas",{url:"/interno",templateUrl:"views/layouts/default.html"}).state("app.interno.senhas.minhas",{url:"/minhas",templateUrl:"views/usuario/senha/minhas.html",controller:"MinhaSenhaController as MinhaSenha"}).state("app.interno.sugestoes",{url:"/sugestoes",templateUrl:"views/layouts/default.html"}).state("app.interno.sugestoes.index",{url:"/list",templateUrl:"views/sugestoes/list.html",controller:"SugestaoListController as SugestaoList"}).state("app.marketing",{url:"/marketing",templateUrl:"views/layouts/default.html"}).state("app.marketing.templateml",{url:"/templateml",templateUrl:"views/marketing/templateml.html",controller:"TemplatemlController as Templateml"}).state("app.produtos",{url:"/produtos",templateUrl:"views/layouts/default.html",data:{roles:["admin","gestor"]}}).state("app.produtos.index",{url:"/list",templateUrl:"views/produto/list.html",controller:"ProdutoListController as ProdutoList",data:{roles:["admin"]}}).state("app.produtos.form",{url:"/{sku}",templateUrl:"views/produto/form.html",controller:"ProdutoFormController as ProdutoForm"}).state("app.produtos.linhas",{url:"/linhas",templateUrl:"views/layouts/default.html"}).state("app.produtos.linhas.index",{url:"/list",templateUrl:"views/produto/linha/list.html",controller:"LinhaListController as LinhaList",data:{roles:["admin"]}}).state("app.produtos.linhas.form",{url:"/{id}",templateUrl:"views/produto/linha/form.html",controller:"LinhaFormController as LinhaForm"}).state("app.produtos.marcas",{url:"/marcas",templateUrl:"views/layouts/default.html"}).state("app.produtos.marcas.index",{url:"/list",templateUrl:"views/produto/marca/list.html",controller:"MarcaListController as MarcaList",data:{roles:["admin"]}}).state("app.produtos.marcas.form",{url:"/{id}",templateUrl:"views/produto/marca/form.html",controller:"MarcaFormController as MarcaForm"}).state("app.inspecao",{url:"/inspecao",templateUrl:"views/layouts/default.html",data:{roles:["admin","tecnico"]}}).state("app.inspecao.realizada",{url:"/realizada",templateUrl:"views/inspecao/realizada/list.html",controller:"InspecaoRealizadaListController as InspecaoRealizadaList"}).state("app.inspecao.fila",{url:"/fila",templateUrl:"views/inspecao/fila/list.html",controller:"InspecaoFilaListController as InspecaoFilaList"}).state("app.inspecao.solicitada",{url:"/solicitada",templateUrl:"views/inspecao/solicitada/list.html",controller:"InspecaoSolicitadaListController as InspecaoSolicitadaList"}).state("app.relatorios",{url:"/relatorios",templateUrl:"views/layouts/default.html",data:{roles:["admin"]}}).state("app.relatorios.pedidos",{url:"/pedidos",templateUrl:"views/relatorio/pedidos.html",controller:"RelatorioPedidosController as RelatorioPedidos"}).state("app.relatorios.produtos",{url:"/produtos",templateUrl:"views/relatorio/produtos.html",controller:"RelatorioProdutosController as RelatorioProdutos"}).state("app.gamification",{url:"/gamification",templateUrl:"views/layouts/default.html"}).state("app.gamification.ranking",{url:"/ranking",templateUrl:"views/gamification/ranking.html",controller:"RankingController as Ranking"}).state("app.gamification.tarefas",{url:"/tarefas",templateUrl:"views/gamification/tarefas/list.html",controller:"TarefaListController as TarefaList"}).state("app.gamification.conquistas",{url:"/conquistas",templateUrl:"views/gamification/conquistas/list.html",controller:"ConquistaListController as ConquistaList"}).state("app.gamification.perfil",{url:"/perfil/?{id}",templateUrl:"views/gamification/perfil.html",controller:"PerfilController as Perfil"})}])}(),function(){"use strict";angular.module("MeuTucano").component("dropdown",{bindings:{title:"@",size:"@"},transclude:!0,templateUrl:"views/components/dropdown.html"})}(),function(){"use strict";angular.module("MeuTucano").component("loading",{bindings:{icon:"@"},templateUrl:"views/components/loading.html"})}(),function(){"use strict";angular.module("MeuTucano").component("logout",{template:'<button ng-click="Logout.logout()" class="logout btn-danger"><i class="fa-sign-out"></i></button>',controller:function($rootScope,$auth,$state){this.logout=function(){$auth.logout().then(function(){localStorage.removeItem("user"),$rootScope.authenticated=!1,$rootScope.currentUser=null,$state.go("login")})}},controllerAs:"Logout"})}(),function(){"use strict";angular.module("MeuTucano").component("menuTucano",{templateUrl:"views/components/menu.html",controller:function($state){var vm=this;vm.openSub=function(menu){angular.forEach(vm.items,function(item){item!==menu&&(item.subOpen=!1)}),menu.subOpen=!menu.subOpen},vm.openInf=function(menu,sub){angular.forEach(menu.sub,function(item){item!==sub&&(item.subOpen=!1)}),sub.subOpen=!sub.subOpen},vm.items=[{title:"Painel",sref:$state.href("app.dashboard"),icon:"fa-dashboard"},{title:"Pedidos",sref:$state.href("app.pedidos.index"),icon:"fa-cubes",roles:["admin","gestor","atendimento","faturamento"]},{title:"Faturamento",sref:$state.href("app.faturamento.index"),icon:"fa-barcode",roles:["admin","faturamento"]},{title:"Clientes",sref:$state.href("app.clientes.index"),icon:"fa-users",roles:["admin","gestor"]},{title:"Produtos",icon:"fa-dropbox",sref:$state.href("app.produtos.index"),roles:["admin","gestor"]},{title:"Rastreios",icon:"fa-truck",roles:["admin","atendimento"],sub:[{title:"Rastreios importantes",icon:"fa-truck",sref:$state.href("app.rastreios.importantes")},{title:"PI's pendentes",icon:"fa-warning",sref:$state.href("app.rastreios.pis.pendentes")},{title:"Devoluções pendentes",icon:"fa-undo",sref:$state.href("app.rastreios.devolucoes")},{title:"Rastreios monitorados",icon:"fa-video-camera ",sref:$state.href("app.rastreios.monitorados")}]},{title:"Relatórios",icon:"fa-pie-chart",sub:[{title:"Pedidos",icon:"fa-cubes",sref:$state.href("app.relatorios.pedidos")},{title:"Produtos",icon:"fa-dropbox",sref:$state.href("app.relatorios.produtos")},{title:"Caixa diário",icon:"fa-money"},{title:"ICMS mensal",icon:"fa-file-pdf-o",sref:$state.href("app.admin.icms")}],roles:["admin","gestor"]},{title:"Marketing",icon:"fa-bullhorn",sub:[{title:"Template ML",icon:"fa-clipboard",sref:$state.href("app.marketing.templateml")}],roles:["admin","marketing"]},{title:"Inspeção técnica",icon:"fa-bug",sub:[{title:"Inspeções Realizadas",icon:"fa-bug",sref:$state.href("app.inspecao.realizada"),roles:["admin","tecnico"]},{title:"Fila de Inspeção",icon:"fa-cogs",sref:$state.href("app.inspecao.fila"),roles:["admin","tecnico"]},{title:"Solicitar Inspeção",icon:"fa-cogs",sref:$state.href("app.inspecao.solicitada"),roles:["admin","atendimento","faturamento"]}]},{title:"Interno",icon:"fa-desktop",sub:[{title:"Usuários",icon:"fa-users",sref:$state.href("app.interno.usuarios.index"),roles:["admin"]},{title:"Minhas senhas",icon:"fa-key",sref:$state.href("app.interno.senhas.minhas")},{title:"Sugestões",icon:"fa-comments-o",sref:$state.href("app.interno.sugestoes.index"),roles:["admin"]}]},{title:"Gamification",icon:"fa-gamepad",sub:[{title:"Ranking",icon:"fa-list-ol",sref:$state.href("app.gamification.ranking")},{title:"Perfil",icon:"fa-user",sref:$state.href("app.gamification.perfil")},{title:"Tarefas",icon:"fa-trophy",sref:$state.href("app.gamification.tarefas")},{title:"Conquistas",icon:"fa-heart",sref:$state.href("app.gamification.conquistas")}],roles:["admin"]}]},controllerAs:"Menu"})}(),function(){"use strict";angular.module("MeuTucano").component("metas",{templateUrl:"views/components/metas.html",controller:function($rootScope,Restangular){var vm=this;vm.data={},vm.loading=!1,vm.loadMeta=function(){vm.loading=!0,Restangular.one("metas/atual").customGET().then(function(metas){vm.data=metas,vm.loading=!1})},vm.loadMeta()},controllerAs:"Metas"})}(),function(){"use strict";angular.module("MeuTucano").component("pageTitle",{bindings:{icon:"@",title:"@",description:"@"},templateUrl:"views/components/page-title.html"})}(),function(){"use strict";angular.module("MeuTucano").component("tableHeader",{bindings:{data:"="},templateUrl:"views/components/table-header.html"}).service("TableHeader",function($localStorage){return{init:function(name,vm,useFilter){return this.name=name,this.vm=vm,$localStorage.pagination||($localStorage.pagination={}),$localStorage.pagination.hasOwnProperty(this.name)||($localStorage.pagination[this.name]={page:1,per_page:"20"}),this.pagination=$localStorage.pagination[this.name],this},prev:function(){return 1!==this.pagination.page&&(this.pagination.page--,void this.vm.load())},next:function(){return this.pagination.page!==this.vm.tableData.last_page&&(this.pagination.page++,void this.vm.load())},changePerPage:function(){this.pagination.page=1,this.vm.load()},reset:function(){this.pagination.page=1,this.vm.load()}}})}(),function(){"use strict";function tableList($rootScope){return{restrict:"A",scope:{tableList:"="},transclude:!0,link:function(scope,element,attrs,ctrl,transclude){element.addClass("table info-style"),transclude(function(clone){element.children("#toTransclude").replaceWith(clone)})},templateUrl:"views/components/table-list.html"}}angular.module("MeuTucano").directive("tableList",tableList)}(),function(){"use strict";angular.module("MeuTucano").service("TabsHelper",function(){var vm=this;return vm.tabs=[],vm.tab=null,{clear:function(){return vm.tabs=[],vm.tab=null,!0},get:function(){return vm.tabs},set:function(tab){var tabs=this.get();for(var i in tabs)if(tabs[i].name===tab||tabs[i].name===tab.name){vm.tab=tabs[i];break}},is:function(tab){return vm.tab.name===tab.name||vm.tab.name===tab},register:function(tab){var match=!1,tabs=this.get();for(var i in tabs)if(tabs[i].name===tab||tabs[i].name===tab.name){match=!0;break}match||vm.tabs.push(tab),vm.tab||(vm.tab=tab)}}}).directive("tabs",["TabsHelper",function(TabsHelper){return{scope:{},transclude:!0,replace:!0,restrict:"E",templateUrl:"views/components/tabs.html",controller:function(){TabsHelper.clear(),this.get=function(){return TabsHelper.get()},this.set=function(tab){TabsHelper.set(tab)},this.is=function(tab){return TabsHelper.is(tab)}},controllerAs:"Tabs"}}]).directive("tab",["TabsHelper",function(TabsHelper){return{restrict:"E",scope:{name:"@",title:"@"},require:"^tabs",template:'<div class="tab-item" ng-class="{ \'active\': Tab.is() }" ng-transclude></div>',replace:!0,transclude:!0,controller:["$scope",function($scope){this.tab={name:$scope.name,title:$scope.title},TabsHelper.register(this.tab),this.is=function(tab){return TabsHelper.is(this.tab)}}],controllerAs:"Tab"}}])}(),function(){"use strict";angular.module("MeuTucano").component("upload",{templateUrl:"views/components/upload.html",controller:function(Upload,toaster,envService,$rootScope,SweetAlert,$timeout){var vm=this;vm.loading=!1,vm.errors=[],vm.resposta=null,vm.statusAberto=!1,vm.removeError=function(error){for(var i=vm.errors.length-1;i>=0;i--)vm.errors[i].chave==error.chave&&vm.errors.splice(i,1);vm.errors.length||(vm.statusAberto=!1)},vm.upload=function(files){files&&files.length&&(vm.loading=!0,vm.statusAberto=!0,$rootScope.$broadcast("loading"),Upload.upload({url:envService.read("apiUrl")+"/upload",headers:{Authorization:"Bearer "+localStorage.getItem("satellizer_token")},data:{arquivos:files}}).success(function(response){vm.loading=!1,vm.resposta=response.data,vm.errors=vm.resposta.errors,$rootScope.$broadcast("upload"),$rootScope.$broadcast("stop-loading"),vm.errors.length||vm.resposta.success!=vm.resposta.total||$timeout(function(){vm.statusAberto=!1}.bind(vm),3e3)}).error(function(){toaster.pop("error","Erro no upload!","Erro ao enviar arquivos, tente novamente!")}))}},controllerAs:"Upload"})}(),function(){"use strict";function AppController($rootScope,focus,envService){var vm=this;vm.searchOpen=!1,vm.user=$rootScope.currentUser,$rootScope.asset=function(assetUrl){return envService.read("assetUrl")+assetUrl},vm.openSearch=function(){vm.searchOpen=!0,focus("searchInput")},$rootScope.$on("closeSearch",function(){vm.searchOpen=!1})}angular.module("MeuTucano").controller("AppController",AppController).filter("digits",function(){return function(text){return String(text).replace(/[^0-9\.]+/g,"")}}).filter("propsFilter",function(){return function(items,props){var out=[];if(angular.isArray(items)){var keys=Object.keys(props);items.forEach(function(item){for(var itemMatches=!1,i=0;i<keys.length;i++){var prop=keys[i],text=props[prop].toLowerCase();if(item[prop].toString().toLowerCase().indexOf(text)!==-1){itemMatches=!0;break}}itemMatches&&out.push(item)})}else out=items;return out}})}(),function(){"use strict";function DashboardController(){var vm=this;vm.load=function(){},vm.load()}angular.module("MeuTucano").controller("DashboardController",DashboardController)}(),function(){"use strict";function confirm($rootScope,SweetAlert){return{restrict:"A",scope:{confirm:"&"},link:function(scope,element,attrs,controllers){element.on("click",function(){SweetAlert.swal({title:"Tem certeza?",text:"Esta ação não poderá ser desfeita!",type:"warning",showCancelButton:!0,cancelButtonText:"Não",confirmButtonColor:"#F55752",confirmButtonText:"Sim!"},function(isConfirm){isConfirm&&scope.confirm()})})}}}angular.module("MeuTucano").directive("confirm",confirm)}(),function(){"use strict";function ngClose(){return function(scope,element,attrs){element.bind("keydown keypress",function(event){27===event.which&&(scope.$apply(function(){scope.$eval(attrs.ngClose,{event:event})}),event.preventDefault())})}}angular.module("MeuTucano").directive("ngClose",ngClose)}(),function(){"use strict";function ngEnter(){return function(scope,element,attrs){element.bind("keydown keypress",function(event){13===event.which&&(scope.$apply(function(){scope.$eval(attrs.ngEnter,{event:event})}),event.preventDefault())})}}angular.module("MeuTucano").directive("ngEnter",ngEnter)}(),function(){"use strict";function roles($rootScope){return{restrict:"A",link:function($scope,$element,$attrs){var makeVisible=function(){$element.removeClass("hidden")},makeHidden=function(){$element.addClass("hidden")},determineVisibility=function(){var result;result=!1,angular.forEach(roles,function(role){_.find($rootScope.currentUser.roles,{name:role})&&(result=!0)}),result===!0?makeVisible():makeHidden()},roles=$attrs.roles;roles.indexOf("|")>=0?roles=roles.split("|"):roles.length>0&&(roles=[roles]),roles.length>0&&determineVisibility()}}}angular.module("MeuTucano").directive("roles",roles)}(),function(){"use strict";function staticInclude($templateRequest,$compile){return{restrict:"A",transclude:!0,replace:!0,scope:!1,link:function($scope,element,attrs){var templatePath=attrs.staticInclude;$templateRequest(templatePath).then(function(response){var contents=element.html(response).contents();$compile(contents)($scope.$new(!1,$scope.$parent))})}}}angular.module("MeuTucano").directive("staticInclude",staticInclude)}(),function(){"use strict";angular.module("MeuTucano").service("ClienteHelper",["ngDialog","toaster","Cliente",function(ngDialog,toaster,Cliente){return{init:function(vm){return this.vm=vm,this},changeEmail:function(cliente,updateVm){ngDialog.open({template:"views/cliente/change_email.html",controller:function(){this.email=cliente.email},controllerAs:"ChangeEmail"}).closePromise.then(function(data){null!==data.value&&"$"!=data.value.substring(0,1)&&(this.vm.loading=!0,Cliente.changeEmail(cliente.id,data.value).then(function(cliente){toaster.pop("success","Sucesso!","E-mail alterado com sucesso!"),this.vm.loading=!1,"undefined"!=typeof this.vm&&"undefined"!=typeof updateVm&&updateVm&&"undefined"!=typeof this.vm.load&&this.vm.load()}.bind(this)))}.bind(this))}}}])}(),function(){"use strict";angular.module("MeuTucano").service("ClienteEnderecoHelper",["ngDialog","Endereco",function(ngDialog,Endereco){return{init:function(vm){return this.vm=vm,this},editar:function(id,updateVm){Endereco.get(id).then(function(endereco){ngDialog.open({template:"views/cliente/endereco/form.html",controller:"EnderecoFormController",controllerAs:"EnderecoForm",data:{endereco:endereco}}).closePromise.then(function(data){updateVm&&"undefined"!=typeof this.vm&&"undefined"!=typeof this.vm.load&&data.value===!0&&this.vm.load()}.bind(this))}.bind(this))}}}])}(),function(){"use strict";angular.module("MeuTucano").service("ComentarioHelper",["$state","ngDialog","SweetAlert","toaster","Comentario",function($state,ngDialog,SweetAlert,toaster,Comentario){return{init:function(vm){return this.vm=vm,this},openModal:function(pedido_id,updateVm){ngDialog.open({template:"views/pedido/comentarios-modal.html",data:{pedido_id:pedido_id},controller:"PedidoComentarioController",controllerAs:"PedidoComentario"}).closePromise.then(function(data){updateVm&&"undefined"!=typeof this.vm&&"undefined"!=typeof this.vm.load&&this.vm.load()}.bind(this))}}}])}(),function(){"use strict";angular.module("MeuTucano").service("InspecaoTecnicaHelper",["toaster","Rastreio","InspecaoTecnica",function(toaster,Rastreio,InspecaoTecnica){return{init:function(vm){return this.vm=vm,this.vm.inspecoes=!1,this},alterarPrioridade:function(pedido_produtos_id,updateVm){InspecaoTecnica.alterarPrioridade(pedido_produtos_id).then(function(){toaster.pop("success","Sucesso!","Prioridade alterada com sucesso!"),"undefined"!=typeof this.vm&&"undefined"!=typeof updateVm&&updateVm&&"undefined"!=typeof this.vm.load&&this.vm.load()}.bind(this))},verificarInspecoes:function(rastreio_id){Rastreio.getInspecaoData(rastreio_id).then(function(response){this.vm.inspecoes=response}.bind(this))},existsSeminovos:function(rastreio_id){Rastreio.existsSeminovos(rastreio_id).then(function(response){this.vm.existsSeminovos=response.exists}.bind(this))}}}])}(),function(){"use strict";angular.module("MeuTucano").service("NotaHelper",["ngDialog","$window","envService","$httpParamSerializer","Restangular","toaster",function(ngDialog,$window,envService,$httpParamSerializer,Restangular,toaster){return{printXML:function(nota_id,devolucao){devolucao="undefined"!=typeof devolucao&&devolucao?1:0;var auth={token:localStorage.getItem("satellizer_token")};$window.open(envService.read("apiUrl")+"/notas/xml/"+nota_id+"/"+devolucao+"?"+$httpParamSerializer(auth),"xml")},printDanfe:function(nota_id){var auth={token:localStorage.getItem("satellizer_token")};$window.open(envService.read("apiUrl")+"/notas/danfe/"+nota_id+"?"+$httpParamSerializer(auth),"danfe")},email:function(nota_id){Restangular.one("notas/email",nota_id).customPOST().then(function(response){response.data.send===!0?toaster.pop("success","Sucesso!","O e-mail foi enviado ao cliente"):toaster.pop("error","Falha!","Não foi possível enviar o e-mail ao cliente")})}}}])}(),function(){"use strict";angular.module("MeuTucano").service("PedidoHelper",["$state","ngDialog","SweetAlert","toaster","Pedido",function($state,ngDialog,SweetAlert,toaster,Pedido){return{init:function(vm){return this.vm=vm,this},parseStatusClass:function(status){switch(status){case"1":case"2":return"info";case"3":return"success";case"4":case"5":return"danger"}},parseRastreioStatusClass:function(status){switch(status){case"1":case"7":case"8":return"info";case"2":return"warning";case"4":return"success";case"3":case"5":case"6":return"danger"}},faturar:function(pedido_id,updateVm){Pedido.faturar(pedido_id).then(function(){toaster.pop("success","Sucesso!","Pedido faturado com sucesso!"),"undefined"!=typeof this.vm&&"undefined"!=typeof updateVm&&updateVm&&"undefined"!=typeof this.vm.load&&this.vm.load()}.bind(this))},cancel:function(pedido,redirect,updateVm){"site"==pedido.marketplace.toLowerCase()||"mercadolivre"==pedido.marketplace.toLowerCase()?SweetAlert.swal({title:"Tem certeza?",text:"Esta ação não poderá ser desfeita!",type:"warning",showCancelButton:!0,cancelButtonText:"Não",confirmButtonColor:"#F55752",confirmButtonText:"Sim!"},function(isConfirm){isConfirm&&(this.vm.loading=!0,Pedido.status(pedido.id,{status:5}).then(function(pedido){toaster.pop("success","Sucesso!","Pedido cancelado com sucesso!"),this.vm.loading=!1,"undefined"!=typeof this.vm&&pedido&&("undefined"!=typeof redirect&&redirect?$state.go(redirect):"undefined"!=typeof updateVm&&updateVm&&"undefined"!=typeof this.vm.load&&this.vm.load())}.bind(this)))}.bind(this)):ngDialog.open({template:"views/pedido/form_cancelamento.html"}).closePromise.then(function(data){isNaN(data.value)||null===data.value||(this.vm.loading=!0,Pedido.status(pedido.id,{status:5,protocolo:data.value}).then(function(pedido){toaster.pop("success","Sucesso!","Pedido cancelado com sucesso!"),this.vm.loading=!1,"undefined"!=typeof this.vm&&pedido&&("undefined"!=typeof redirect&&redirect?$state.go(redirect):"undefined"!=typeof updateVm&&updateVm&&"undefined"!=typeof this.vm.load&&this.vm.load())}.bind(this)))}.bind(this))}}}])}(),function(){"use strict";angular.module("MeuTucano").service("RastreioHelper",["$window","$httpParamSerializer","envService","ngDialog","toaster","Rastreio","Devolucao","Pi","Logistica",function($window,$httpParamSerializer,envService,ngDialog,toaster,Rastreio,Devolucao,Pi,Logistica){return{init:function(vm){return this.vm=vm,this},devolucao:function(id,updateVm){Devolucao.get(id).then(function(devolucao){ngDialog.open({template:"views/rastreio/devolucao/form.html",controller:"DevolucaoFormController",controllerAs:"DevolucaoForm",data:{devolucao:devolucao||{rastreio_id:id}}}).closePromise.then(function(data){updateVm&&"undefined"!=typeof this.vm&&"undefined"!=typeof this.vm.load&&data.value===!0&&this.vm.load()}.bind(this))}.bind(this))},pi:function(id,updateVm){Pi.get(id).then(function(pi){ngDialog.open({template:"views/rastreio/pi/form.html",className:"ngdialog-theme-default ngdialog-big",controller:"PiFormController",controllerAs:"PiForm",data:{pi:pi||{rastreio_id:id}}}).closePromise.then(function(data){updateVm&&"undefined"!=typeof this.vm&&"undefined"!=typeof this.vm.load&&data.value===!0&&this.vm.load()}.bind(this))}.bind(this))},logistica:function(id,updateVm){Logistica.get(id).then(function(logistica){ngDialog.open({template:"views/rastreio/logistica/form.html",className:"ngdialog-theme-default ngdialog-big",controller:"LogisticaFormController",controllerAs:"Logistica",data:{logistica:logistica||{rastreio_id:id}}}).closePromise.then(function(data){updateVm&&"undefined"!=typeof this.vm&&"undefined"!=typeof this.vm.load&&data.value===!0&&this.vm.load()}.bind(this))}.bind(this))},editar:function(rastreio_id,updateVm){Rastreio.get(rastreio_id).then(function(rastreio){ngDialog.open({template:"views/rastreio/partials/editar.html",controller:"EditarController",controllerAs:"Editar",data:{rastreio:rastreio}}).closePromise.then(function(data){updateVm&&"undefined"!=typeof this.vm&&"undefined"!=typeof this.vm.load&&data.value===!0&&this.vm.load()}.bind(this))}.bind(this))},printEtiqueta:function(rastreio_id){var auth={token:localStorage.getItem("satellizer_token")};$window.open(envService.read("apiUrl")+"/rastreios/etiqueta/"+rastreio_id+"?"+$httpParamSerializer(auth),"etiqueta")},printHistorico:function(rastreio_id){var auth={token:localStorage.getItem("satellizer_token")};$window.open(envService.read("apiUrl")+"/rastreios/historico/"+rastreio_id+"?"+$httpParamSerializer(auth),"historico")},imagem:function(rastreio_id,updateVm){Rastreio.historico(rastreio_id).then(function(){updateVm&&"undefined"!=typeof this.vm&&"undefined"!=typeof this.vm.load&&this.vm.load()}.bind(this))},generateCode:function(servico){"undefined"==typeof servico&&(servico=this.codigo.servico),this.codigo.rastreio="Gerando...",Rastreio.codigo(servico).then(function(response){this.codigo.rastreio=response.codigo,response.hasOwnProperty("error")&&(this.codigo.rastreio="Códigos esgotados!",toaster.pop("error","Erro",response.error)),response.hasOwnProperty("msg")&&toaster.pop("warning","Atenção",response.msg)}.bind(this))},codeCopied:function(){toaster.pop("success","Sucesso!","O código foi copiado para sua área de transferência.")},monitorar:function(rastreio_id,monitorar,updateVm){Rastreio.monitorar(rastreio_id,monitorar).then(function(){toaster.pop("success","Sucesso!","Agora você está monitorando este rastreio."),updateVm&&"undefined"!=typeof this.vm&&("undefined"!=typeof this.vm.loadRastreios?this.vm.loadRastreios():"undefined"!=typeof this.vm.load&&this.vm.load())}.bind(this))},parseStatusClass:function(rastreio_status){switch(rastreio_status){case"1":case"7":case"8":return"info";case"2":return"warning";case"4":return"success";case"3":case"5":case"6":return"danger"}}}}])}(),function(){"use strict";angular.module("MeuTucano").service("SugestaoHelper",["$window","$httpParamSerializer","envService","ngDialog","toaster","Rastreio","Devolucao","Pi","Logistica",function($window,$httpParamSerializer,envService,ngDialog,toaster,Rastreio,Devolucao,Pi,Logistica){return{init:function(vm){return this.vm=vm,this},sugestao:function(id,updateVm){ngDialog.open({template:"views/sugestoes/form.html",controller:"SugestaoFormController",controllerAs:"SugestaoForm"})}}}])}(),angular.module("ngLocale",[],["$provide",function($provide){var PLURAL_CATEGORY={ZERO:"zero",ONE:"one",TWO:"two",FEW:"few",MANY:"many",OTHER:"other"};$provide.value("$locale",{DATETIME_FORMATS:{AMPMS:["AM","PM"],DAY:["domingo","segunda-feira","terça-feira","quarta-feira","quinta-feira","sexta-feira","sábado"],ERANAMES:["Antes de Cristo","Ano do Senhor"],
ERAS:["a.C.","d.C."],FIRSTDAYOFWEEK:6,MONTH:["janeiro","fevereiro","março","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"],SHORTDAY:["dom","seg","ter","qua","qui","sex","sáb"],SHORTMONTH:["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"],STANDALONEMONTH:["janeiro","fevereiro","março","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"],WEEKENDRANGE:[5,6],fullDate:"EEEE, d 'de' MMMM 'de' y",longDate:"d 'de' MMMM 'de' y",medium:"d 'de' MMM 'de' y HH:mm:ss",mediumDate:"d 'de' MMM 'de' y",mediumTime:"HH:mm:ss",short:"dd/MM/yy HH:mm",shortDate:"dd/MM/yy",shortTime:"HH:mm"},NUMBER_FORMATS:{CURRENCY_SYM:"R$",DECIMAL_SEP:",",GROUP_SEP:".",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"-¤",negSuf:"",posPre:"¤",posSuf:""}]},id:"pt-br",localeID:"pt_BR",pluralCat:function(n,opt_precision){return n>=0&&n<=2&&2!=n?PLURAL_CATEGORY.ONE:PLURAL_CATEGORY.OTHER}})}]),function(){"use strict";angular.module("MeuTucano").provider("envService",function(){this.environment="development",this.data={},this.config=function(config){this.data=config},this.set=function(environment){this.environment=environment},this.get=function(){return this.environment},this.read=function(variable){return"all"!==variable?this.data.vars[this.get()][variable]:this.data.vars[this.get()]},this.is=function(environment){return environment===this.environment},this.check=function(){var location=window.location.href,self=this;angular.forEach(this.data.domains,function(v,k){angular.forEach(v,function(v){location.match("//"+v)&&(self.environment=k)})})},this.$get=function(){return this}})}(),function(){"use strict";angular.module("MeuTucano").service("Filter",["$rootScope","$timeout","$localStorage",function($rootScope,$timeout,$localStorage){return{init:function(name,vm,operators){this.name=name,this.vm=vm,this.operators=operators,$localStorage.filter||($localStorage.filter={}),$localStorage.filter.hasOwnProperty(this.name)&&(this.vm.filter=$localStorage.filter[this.name]);var initializing=!0;return $rootScope.$watch(function(){return vm.filter},function(){initializing?$timeout(function(){initializing=!1}):(angular.forEach(this.vm.filter,function(value,key){value&&null!==value&&0!==value.length?"object"==typeof value&&(null===value.from&&null===value.to||"undefined"==typeof value.to&&null===value.from||"undefined"==typeof value.from&&null===value.to)&&delete this.vm.filter[key]:delete this.vm.filter[key]},this),$localStorage.filter[this.name]=angular.extend($localStorage.filter[this.name]||{},this.vm.filter),this.vm.hasOwnProperty("tableHeader")&&(this.vm.tableHeader.pagination.page=1),this.vm.load())}.bind(this),!0),this},parse:function(){return this.parsedFilter=[],angular.forEach(this.vm.filter,function(value,key){var op=this.operators[key]||"=";this.parsedFilter.push({column:key,operator:op,value:value})},this),this.parsedFilter},clear:function(){this.vm.filter={},$localStorage.filter[this.name]={}}}}])}(),function(){"use strict";angular.module("MeuTucano").service("Rest",["Restangular",function(Restangular){return{baseUrl:"",getList:function(params){return params=this.parseParams(params),Restangular.all(this.baseUrl+"/list").customGET("",params||{})},parseParams:function(params){return params&&angular.forEach(["join","filter","fields","with"],function(value){this.hasOwnProperty(value)&&(this[value]=JSON.stringify(this[value]))},params),params},get:function(id){return Restangular.one(this.baseUrl,id).get()},create:function(params){return Restangular.all(this.baseUrl).post(params)},update:function(id,params){return Restangular.one(this.baseUrl,id).customPUT(params||{})},save:function(params,id){return id?this.update(id,params):this.create(params)},delete:function(id){return Restangular.one(this.baseUrl,id).remove()}}}])}(),function(){"use strict";function ToasterInterceptor($q,toaster){return{responseError:function(rejection){return rejection.data.hasOwnProperty("msg")&&toaster.pop("error","Houve um problema",rejection.data.msg),$q.reject(rejection)}}}angular.module("MeuTucano").factory("ToasterInterceptor",ToasterInterceptor)}(),function(){"use strict";angular.module("MeuTucano").component("caixaSugestao",{templateUrl:"views/components/dashboard/caixa-sugestao.html",controller:function(SugestaoHelper){var vm=this;vm.sugestaoHelper=SugestaoHelper.init(vm)}})}(),function(){"use strict";angular.module("MeuTucano").component("chartStatusByMarketplace",{bindings:{title:"@"},templateUrl:"views/components/dashboard/chart-status-by-marketplace.html",controller:function(Pedido){var vm=this;vm.chartOrdersStatus={credits:!1,loading:!0,size:{height:276},options:{exporting:{enabled:!1},title:!1,legend:!1,chart:{type:"bar"},plotOptions:{series:{stacking:"normal",allowPointSelect:!0}}},yAxis:{title:!1},xAxis:{},series:[]},vm.loadTotalOrdersStatus=function(){vm.chartOrdersStatus.loading=!0,Pedido.totalOrdersStatus().then(function(response){vm.chartOrdersStatus.loading=!1,vm.chartOrdersStatus.xAxis={categories:response.marketplaces},vm.chartOrdersStatus.series=[],vm.chartOrdersStatus.series.push({name:"Pendentes",data:response.pendente,color:"#E6E6E6",id:"pendentes"}),vm.chartOrdersStatus.series.push({name:"Pagos",data:response.pago,color:"#48B0F7",id:"pagos"}),vm.chartOrdersStatus.series.push({name:"Enviados",data:response.enviado,color:"#437DA5",id:"enviados"}),vm.chartOrdersStatus.series.push({name:"Entregues",data:response.entregue,color:"#10CFBD",id:"entregues"});var maior=0,total=0;if("undefined"!=typeof vm.chartOrdersStatus.series[0].data){for(var i=0;i<vm.chartOrdersStatus.series[0].data.length;i++){total=0;for(var k in vm.chartOrdersStatus.series)total+=vm.chartOrdersStatus.series[k].data[i];total>maior&&(maior=total)}vm.chartOrdersStatus.yAxis.max=maior}})},vm.load=function(){vm.loadTotalOrdersStatus()},vm.load()}})}(),function(){"use strict";angular.module("MeuTucano").component("chartTotalOrders",{bindings:{title:"@"},templateUrl:"views/components/dashboard/chart-total-orders.html",controller:function(Pedido){var vm=this;vm.chartOrders={mes:null,ano:null,credits:!1,loading:!0,size:{height:276},options:{exporting:{enabled:!1},tooltip:{followPointer:!0,shared:!0,headerFormat:'<span style="font-size: 10px">Dia {point.key}</span><br/>'},title:!1,legend:!1},yAxis:{title:!1,min:0},xAxis:{categories:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28]},series:[]},vm.loadTotalOrders=function(clear){vm.chartOrders.loading=!0,clear===!0&&(vm.chartOrders.mes=null,vm.chartOrders.ano=null),Pedido.totalOrders(vm.chartOrders.mes,vm.chartOrders.ano).then(function(response){if(1==response.mes?(vm.chartOrders.mes=12,vm.chartOrders.ano=response.ano-1):(vm.chartOrders.mes=response.mes-1,vm.chartOrders.ano=response.ano),response.data.length>vm.chartOrders.xAxis.categories.length)for(var i=vm.chartOrders.xAxis.categories.length;i<response.data.length;i++)vm.chartOrders.xAxis.categories.push(i);vm.chartOrders.loading=!1,clear===!0&&(vm.chartOrders.series=[],vm.chartOrders.options.legend=!1),vm.chartOrders.series.push({name:response.name,data:response.data}),vm.chartOrders.series.length>1&&(vm.chartOrders.options.legend={})})},vm.load=function(){vm.loadTotalOrders()},vm.load()}})}(),function(){"use strict";angular.module("MeuTucano").component("rastreiosMonitorados",{bindings:{title:"@"},templateUrl:"views/components/dashboard/rastreios-monitorados.html",controller:function($rootScope,RastreioHelper,Monitorado,Pedido){var vm=this;vm.rastreioHelper=RastreioHelper.init(vm),vm.loadRastreios=function(){vm.loading=!0,vm.rastreiosMonitorados={},Monitorado.simpleList().then(function(response){vm.rastreiosMonitorados=response,vm.loading=!1})},vm.load=function(){angular.forEach($rootScope.currentUser.roles,function(role){role.name==role&&vm.loadRastreios()})},vm.load()}})}(),function(){"use strict";angular.module("MeuTucano").component("totalOrdersByDate",{bindings:{title:"@"},templateUrl:"views/components/dashboard/total-orders-by-date.html",controller:function(Pedido){var vm=this;vm.ordersDate={},vm.loadTotalOrdersDate=function(){vm.ordersDate={},Pedido.totalOrdersDate().then(function(response){vm.ordersDate=response})},vm.load=function(){vm.loadTotalOrdersDate()},vm.load()}})}(),function(){"use strict";function IcmsController($rootScope,Restangular,envService,$window,$httpParamSerializer){var vm=this;vm.generateRelatorio=function(){var auth={token:localStorage.getItem("satellizer_token")};$window.open(envService.read("apiUrl")+"/relatorios/icms?"+$httpParamSerializer(auth))}}angular.module("MeuTucano").controller("IcmsController",IcmsController)}(),function(){"use strict";function AuthController($auth,$http,$state,$rootScope,focus,envService){var vm=this;vm.username=localStorage.getItem("lastUser"),focus(vm.username?"password":"username"),vm.login=function(){vm.loading=!0,localStorage.setItem("lastUser",vm.username);var credentials={username:vm.username,password:vm.password};$auth.login(credentials).then(function(){return $http.get(envService.read("apiUrl")+"/authenticate/user")}).then(function(response){vm.loading=!1;var user=JSON.stringify(response.data.user);localStorage.setItem("user",user),$rootScope.authenticated=!0,$rootScope.currentUser=response.data.user,$state.go("app.dashboard")})}}angular.module("MeuTucano").controller("AuthController",AuthController)}(),function(){"use strict";function ClienteDetalheController($stateParams,Cliente,ClienteEnderecoHelper,ClienteHelper){var vm=this;vm.cliente_id=$stateParams.id,vm.cliente={},vm.loading=!1,vm.clienteEnderecoHelper=ClienteEnderecoHelper.init(vm),vm.clienteHelper=ClienteHelper.init(vm),vm.load=function(){vm.cliente={},vm.loading=!0,Cliente.detail(vm.cliente_id).then(function(cliente){vm.cliente=cliente,vm.loading=!1})},vm.load(),vm.parseStatusClass=function(pedido){switch(pedido.status){case"1":case"2":return"info";case"3":return"success";case"4":case"5":return"danger"}}}angular.module("MeuTucano").controller("ClienteDetalheController",ClienteDetalheController)}(),function(){"use strict";function ClienteListController(Cliente,Filter,TableHeader){var vm=this;vm.filterList=Filter.init("clientes",vm,{"clientes.nome":"LIKE","clientes.taxvat":"LIKE"}),vm.tableHeader=TableHeader.init("clientes",vm),vm.load=function(){vm.loading=!0,Cliente.getList({fields:["clientes.*"],filter:vm.filterList.parse(),page:vm.tableHeader.pagination.page,per_page:vm.tableHeader.pagination.per_page}).then(function(response){vm.tableData=response,vm.loading=!1})},vm.load()}angular.module("MeuTucano").controller("ClienteListController",ClienteListController)}(),function(){"use strict";function FaturamentoController($rootScope,Restangular,toaster){var vm=this;vm.notas=[],vm.codigo={servico:"0"},vm.loading=!1,vm.generating=!1,$rootScope.$on("upload",function(){vm.load()}),$rootScope.$on("loading",function(){vm.loading=!0}),$rootScope.$on("stop-loading",function(){vm.loading=!1}),vm.load=function(){vm.notas=[],vm.loading=!0,Restangular.all("notas/faturamento").getList().then(function(notas){vm.notas=notas,vm.loading=!1})},vm.load(),vm.generateCode=function(){vm.codigo.rastreio="Gerando...",Restangular.one("codigos/gerar",vm.codigo.servico).customGET().then(function(response){vm.codigo.rastreio=response.codigo,response.hasOwnProperty("error")&&(vm.codigo.rastreio="Códigos esgotados!",toaster.pop("error","Erro",response.error)),response.hasOwnProperty("msg")&&toaster.pop("warning","Atenção",response.msg),vm.codigo.mensagem=response.msg})},vm.faturar=function(pedido_id){Restangular.one("notas/faturar",pedido_id).customGET().then(function(response){toaster.pop("success","Sucesso!","Pedido faturado com sucesso!")})}}angular.module("MeuTucano").controller("FaturamentoController",FaturamentoController)}(),function(){"use strict";function FaturamentoListController(toaster,Filter,Pedido,TableHeader,RastreioHelper,NotaHelper,PedidoHelper,ComentarioHelper,$rootScope){var vm=this;vm.notaHelper=NotaHelper,vm.rastreioHelper=RastreioHelper.init(vm),vm.pedidoHelper=PedidoHelper.init(vm),vm.comentarioHelper=ComentarioHelper.init(vm),vm.filterList=Filter.init("faturamento",vm,{"pedidos.codigo_marketplace":"LIKE","clientes.nome":"LIKE"}),vm.tableHeader=TableHeader.init("faturamento",vm),vm.load=function(){vm.loading=!0,Pedido.faturamento({fields:["pedidos.*"],filter:vm.filterList.parse(),page:vm.tableHeader.pagination.page,per_page:vm.tableHeader.pagination.per_page}).then(function(response){vm.tableData=response,vm.loading=!1})},vm.load(),$rootScope.$on("upload",function(){vm.load()}),vm.chaveCopiada=function(){toaster.pop("info","","A chave da nota foi copiada para sua área de transferência!")}}angular.module("MeuTucano").controller("FaturamentoListController",FaturamentoListController)}(),function(){"use strict";function AvatarFormController($scope,toaster,envService,Upload,Gamification){var vm=this;"undefined"!=typeof $scope.ngDialogData.usuario?vm.usuario=angular.copy($scope.ngDialogData.usuario):(toaster.pop("error","Erro!","Não foi possível encontrar seu avatar!"),$scope.closeThisDialog(!0)),vm.imagem=null,vm.save=function(){vm.usuario.gamification.avatar?vm.imagem&&Upload.upload({url:envService.read("apiUrl")+"/gamification/upload",headers:{Authorization:"Bearer "+localStorage.getItem("satellizer_token")},data:{arquivo:Upload.dataUrltoBlob(vm.usuario.gamification.avatar,vm.imagem.name)}}).success(function(response){toaster.pop("success","Upload concluído",response.data.msg),vm.usuario.gamification.avatar=response.data,Gamification.avatar(vm.usuario.gamification.id,vm.usuario.gamification.avatar).then(function(){toaster.pop("success","Sucesso!","Avatar salvo com sucesso!"),$scope.closeThisDialog(!0)})}).error(function(){toaster.pop("error","Erro no upload!","Erro ao enviar arquivos, tente novamente!")}):toaster.pop("error","Erro no upload!","Tem certeza que você selecionou uma imagem?")}}angular.module("MeuTucano").controller("AvatarFormController",AvatarFormController)}(),function(){"use strict";function PerfilController($stateParams,ngDialog,Gamification){var vm=this;"undefined"!=typeof $stateParams.id?(vm.usuario={id:$stateParams.id},vm.proprio=!1):(vm.usuario={},vm.proprio=!0),vm.grafico={credits:!1,loading:!0,size:{height:254},options:{tooltip:{followPointer:!0,formatter:function(){return"Dia "+this.x+": <b>"+this.y+"</b> tarefas"}},chart:{type:"areaspline"},title:!1,legend:!1},yAxis:{title:{text:"Tarefas"},min:0},xAxis:{categories:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28]},series:[]},vm.load=function(){vm.loading=!0,Gamification.perfil(vm.usuario.id||null).then(function(response){vm.votos=response.votos,vm.conquistas=response.conquistas,vm.usuario=response.usuario,vm.grafico.series.push({name:"Tarefas",data:response.grafico}),vm.grafico.loading=!1,vm.loading=!1})},vm.load(),vm.openForm=function(usuario){ngDialog.open({template:"views/gamification/avatar.html",controller:"AvatarFormController",controllerAs:"AvatarForm",data:{usuario:usuario||{}}}).closePromise.then(function(data){data.value===!0&&vm.load()})}}angular.module("MeuTucano").controller("PerfilController",PerfilController)}(),function(){"use strict";function RankingController(toaster,Gamification,Voto){var vm=this;vm.dados={},vm.load=function(){Gamification.ranking().then(function(response){vm.dados=response})},vm.load(),vm.votar=function(candidato_id){Voto.save({candidato_id:candidato_id}).then(function(response){"undefined"!=typeof response.erro?toaster.pop("error","Erro!",response.erro):(toaster.pop("success","Voto confirmado!",""),vm.load())})}}angular.module("MeuTucano").controller("RankingController",RankingController)}(),function(){"use strict";function InspecaoFilaListController(InspecaoTecnica,Filter,TableHeader,ngDialog){var vm=this;vm.filterList=Filter.init("inspecao_tecnica_fila",vm,{"inspecao_tecnica.created_at":"BETWEEN","pedidos.codigo_marketplace":"LIKE","usuarios.name":"LIKE","produtos.titulo":"LIKE"}),vm.tableHeader=TableHeader.init("inspecao_tecnica_fila",vm),vm.load=function(){vm.loading=!0,InspecaoTecnica.fila({fields:["inspecao_tecnica.*"],filter:vm.filterList.parse(),page:vm.tableHeader.pagination.page,per_page:vm.tableHeader.pagination.per_page}).then(function(response){vm.tableData=response,vm.loading=!1})},vm.load(),vm.openForm=function(inspecao){ngDialog.open({template:"views/inspecao/form.html",controller:"InspecaoTecnicaFormController",controllerAs:"InspecaoTecnicaForm",data:{inspecao:inspecao||{}}}).closePromise.then(function(data){data.value===!0&&vm.load()})}}angular.module("MeuTucano").controller("InspecaoFilaListController",InspecaoFilaListController)}(),function(){"use strict";function InspecaoRealizadaListController(InspecaoTecnica,Filter,TableHeader,ngDialog){var vm=this;vm.filterList=Filter.init("inspecao_tecnica_realizada",vm,{"inspecao_tecnica.created_at":"BETWEEN","pedidos.codigo_marketplace":"LIKE","produtos.titulo":"LIKE","tecnico_table.name":"LIKE","solicitante_table.name":"LIKE"}),vm.tableHeader=TableHeader.init("inspecao_tecnica_realizada",vm),vm.load=function(){vm.loading=!0,InspecaoTecnica.getList({fields:["inspecao_tecnica.*"],filter:vm.filterList.parse(),page:vm.tableHeader.pagination.page,per_page:vm.tableHeader.pagination.per_page}).then(function(response){vm.tableData=response,vm.loading=!1})},vm.load(),vm.openForm=function(inspecao){ngDialog.open({template:"views/inspecao/form.html",controller:"InspecaoTecnicaFormController",controllerAs:"InspecaoTecnicaForm",data:{inspecao:inspecao||{}}}).closePromise.then(function(data){data.value===!0&&vm.load()})}}angular.module("MeuTucano").controller("InspecaoRealizadaListController",InspecaoRealizadaListController)}(),function(){"use strict";function InspecaoSolicitadaListController(toaster,ngDialog,Filter,TableHeader,InspecaoTecnica){var vm=this;vm.filterList=Filter.init("inspecao_tecnica_solicitada",vm,{"inspecao_tecnica.created_at":"BETWEEN","pedidos.codigo_marketplace":"LIKE","produtos.titulo":"LIKE","tecnico_table.name":"LIKE","solicitante_table.name":"LIKE"}),vm.tableHeader=TableHeader.init("inspecao_tecnica_solicitada",vm),vm.load=function(){vm.loading=!0,InspecaoTecnica.solicitadas({fields:["inspecao_tecnica.*"],filter:vm.filterList.parse(),page:vm.tableHeader.pagination.page,per_page:vm.tableHeader.pagination.per_page}).then(function(response){vm.tableData=response,vm.loading=!1})},vm.load(),vm.openForm=function(inspecao){ngDialog.open({template:"views/inspecao/solicitada/form.html",controller:"InspecaoSolicitarFormController",controllerAs:"InspecaoSolicitarForm"}).closePromise.then(function(data){data.value===!0&&vm.load()})},vm.destroy=function(inspecao){InspecaoTecnica.delete(inspecao.id).then(function(){toaster.pop("success","Sucesso!","Inspeção técnica excluida com sucesso!")})}}angular.module("MeuTucano").controller("InspecaoSolicitadaListController",InspecaoSolicitadaListController)}(),function(){"use strict";function InspecaoSolicitarFormController($scope,toaster,SweetAlert,InspecaoTecnica,Produto){var vm=this;vm.confirmando=!1,vm.acoes={},vm.produtos=[],vm.solicitacao={quantidade:1},vm.search=function(term){term&&Produto.search(term,1).then(function(response){vm.produtos=response})},vm.save=function(){vm.confirmando?vm.acoes&&(vm.acoes.produto_sku=vm.solicitacao.produto.sku,InspecaoTecnica.reserva(vm.acoes).then(function(response){if($scope.closeThisDialog(!0),console.log(response.dados),response.dados.length){var dados=response.dados,string="";for(var i in dados)console.log(dados[i]),string+=0!=dados[i].novo?"A inspeção "+dados[i].antigo+" foi ocupada e agora substituida por "+dados[i].novo+".</br>":"A inspeção "+dados[i].antigo+" foi ocupada. Uma nova foi adicionada à fila.</br>";SweetAlert.swal({title:"Atenção!",text:string,html:!0,type:"warning"})}else toaster.pop("success","Sucesso!","Sua solitação foi feita com sucesso!")})):"undefined"!=typeof vm.solicitacao.produto&&InspecaoTecnica.verificarReserva({produto:vm.solicitacao.produto.sku,quantidade:vm.solicitacao.quantidade}).then(function(response){vm.acoes=response,vm.confirmando=!0})}}angular.module("MeuTucano").controller("InspecaoSolicitarFormController",InspecaoSolicitarFormController)}(),function(){"use strict";function InspecaoTecnicaFormController($rootScope,$scope,$state,$stateParams,InspecaoTecnica,Produto,toaster){var vm=this;vm.produtos=[],"undefined"!=typeof $scope.ngDialogData.inspecao?vm.inspecao=angular.copy($scope.ngDialogData.inspecao):vm.inspecao={},vm.load=function(){vm.loading=!0,InspecaoTecnica.get(vm.inspecao.id).then(function(inspecao){vm.inspecao=inspecao,"undefined"!=typeof vm.inspecao.produto&&vm.inspecao.produto&&(vm.produtos=[vm.inspecao.produto]),vm.loading=!1})},vm.inspecao.id&&vm.load(),vm.search=function(term){term&&Produto.search(term,1).then(function(response){vm.produtos=response})},vm.save=function(){"undefined"!=typeof vm.inspecao.produto&&(vm.inspecao.produto_sku=vm.inspecao.produto.sku),InspecaoTecnica.save(vm.inspecao,vm.inspecao.id||null).then(function(){toaster.pop("success","Sucesso!","Inspeção técnica salva com sucesso!"),$scope.closeThisDialog(!0)})},vm.destroy=function(){InspecaoTecnica.delete(vm.inspecao.id).then(function(){toaster.pop("success","Sucesso!","Inspeção técnica excluida com sucesso!"),$scope.closeThisDialog(!0)})}}angular.module("MeuTucano").controller("InspecaoTecnicaFormController",InspecaoTecnicaFormController)}(),function(){"use strict";function TemplatemlController(Restangular){var vm=this;vm.generateTemplate=function(){console.log(vm.url),Restangular.one("templateml/gerar").customGET("",{url:vm.url}).then(function(response){vm.template=response.template})}}angular.module("MeuTucano").controller("TemplatemlController",TemplatemlController)}(),function(){"use strict";function SearchController($rootScope,$state,Restangular,PedidoHelper,ComentarioHelper){var vm=this;vm.comentarioHelper=ComentarioHelper,vm.term=null,vm.loading=!1,vm.data={pedidos:null,produtos:null,clientes:null,rastreios:null},vm.goTo=function(to,params){vm.close(),$state.go(to,params)},vm.pedidoHelper=PedidoHelper,vm.load=function(){"undefined"!=typeof vm.term&&vm.term&&vm.term.length>2&&(vm.data={},vm.loading=!0,Restangular.one("search").get({term:vm.term}).then(function(data){vm.data=data,vm.loading=!1}))},vm.close=function(){$rootScope.$broadcast("closeSearch")}}angular.module("MeuTucano").controller("SearchController",SearchController).filter("highlight",function($sce){return function(text,phrase){return phrase&&(text=String(text).replace(new RegExp("("+phrase+")","gi"),'<span class="underline">$1</span>')),$sce.trustAsHtml(text)}})}(),function(){"use strict";function PedidoComentarioController($rootScope,$stateParams,$scope,Restangular,toaster,ngDialog,Comentario){var vm=this;vm.comentarios=[],vm.pedido_id=("undefined"!=typeof $scope.ngDialogData?$scope.ngDialogData.pedido_id:null)||$stateParams.id,vm.loading=!1,vm.load=function(){vm.loading=!0,Comentario.getFromOrder(vm.pedido_id).then(function(comentarios){vm.loading=!1,vm.comentarios=comentarios})},vm.load(),vm.save=function(){vm.loading=!0,Comentario.save({pedido_id:vm.pedido_id,comentario:vm.comentario}).then(function(){vm.loading=!1,vm.comentario=null,vm.formComentario.$setPristine(),vm.load(),toaster.pop("success","Sucesso!","Comentário cadastrado com sucesso!")})},vm.destroy=function(comentario){vm.loading=!0,Comentario.delete(comentario).then(function(){vm.loading=!1,vm.load(),toaster.pop("success","Sucesso!","Comentário excluído com sucesso!")})}}angular.module("MeuTucano").controller("PedidoComentarioController",PedidoComentarioController)}(),function(){"use strict";function PedidoDetalheController($rootScope,$state,$stateParams,ngDialog,SweetAlert,toaster,Pedido,RastreioHelper,NotaHelper,ClienteEnderecoHelper,PedidoHelper,ClienteHelper,InspecaoTecnicaHelper){var vm=this;vm.pedido_id=$stateParams.id,vm.pedido={},vm.loading=!1,vm.notaHelper=NotaHelper,vm.rastreioHelper=RastreioHelper.init(vm),vm.clienteEnderecoHelper=ClienteEnderecoHelper.init(vm),vm.pedidoHelper=PedidoHelper.init(vm),vm.clienteHelper=ClienteHelper.init(vm),vm.inspecaoTecnicaHelper=InspecaoTecnicaHelper.init(vm),vm.load=function(){vm.loading=!0,Pedido.get(vm.pedido_id).then(function(pedido){vm.pedido=pedido,vm.loading=!1})},vm.load(),vm.toggleHold=function(){Pedido.segurar(vm.pedido.id,!vm.pedido.segurado).then(function(pedido){vm.load(),vm.loading=!1,toaster.pop("success","Sucesso!","Pedido "+(vm.pedido.segurado?"segurado":"liberado")+" com sucesso!")})},vm.togglePriority=function(){vm.loading=!0,Pedido.prioridade(vm.pedido.id,!vm.pedido.priorizado).then(function(pedido){vm.load(),vm.loading=!1,toaster.pop("success","Sucesso!","Prioridade do pedido alterada com sucesso!")})},vm.parseStatusClass=function(){switch(vm.pedido.status){case"1":case"2":return"info";case"3":return"success";case"4":case"5":return"danger"}},vm.parseRastreioStatusClass=function(rastreio){switch(rastreio.status){case"1":case"7":case"8":return"info";case"2":return"warning";case"4":return"success";case"3":case"5":case"6":return"danger"}}}angular.module("MeuTucano").controller("PedidoDetalheController",PedidoDetalheController)}(),function(){"use strict";function PedidoListController(Pedido,Filter,TableHeader){var vm=this;vm.filterList=Filter.init("pedidos",vm,{"pedidos.codigo_marketplace":"LIKE","clientes.nome":"LIKE","pedidos.total":"BETWEEN","pedidos.created_at":"BETWEEN"}),vm.tableHeader=TableHeader.init("pedidos",vm),vm.load=function(){vm.loading=!0,Pedido.getList({fields:["pedidos.*"],filter:vm.filterList.parse(),page:vm.tableHeader.pagination.page,per_page:vm.tableHeader.pagination.per_page}).then(function(response){vm.tableData=response,vm.loading=!1})},vm.load(),vm.parseStatusClass=function(pedido){switch(pedido.status){case"1":case"2":return"info";case"3":return"success";case"4":case"5":return"danger"}}}angular.module("MeuTucano").controller("PedidoListController",PedidoListController)}(),function(){"use strict";function ProdutoFormController($state,$stateParams,SweetAlert,toaster,TabsHelper,Produto,Linha,Marca,Atributo){var vm=this,original={linha_id:null,attrs:null};vm.produto={sku:$stateParams.sku||null,unidade:"un",ativo:"1",estado:"0"},vm.sku={original:vm.produto.sku,gerado:!1},vm.tabsHelper=TabsHelper,vm.linhas={},vm.marcas={},vm.load=function(){vm.loading=!0,Produto.get(vm.produto.sku).then(function(produto){vm.produto=produto,vm.produto.unidade||(vm.produto.unidade="un"),null===vm.produto.ativo&&(vm.produto.ativo="1"),null===vm.produto.estado&&(vm.produto.estado="0"),vm.produto.linha_id&&(original.linha_id=vm.produto.linha_id),vm.produto.linha_id&&vm.produto.atributos&&(original.attrs=vm.produto.atributos),vm.produto.linha_id&&vm.loadAtributos(),vm.loading=!1})},vm.loadLinhas=function(){vm.loading=!0,Linha.getList().then(function(linhas){vm.linhas=linhas,vm.loading=!1})},vm.loadMarcas=function(){vm.loading=!0,Marca.getList().then(function(marcas){vm.marcas=marcas,vm.loading=!1})},vm.loadAtributos=function(){vm.loading=!0,Atributo.fromLinha(vm.produto.linha_id).then(function(atributos){if(vm.loading=!1,vm.produto.linha_id==original.linha_id&&original.attrs){original.attrs;for(var i in atributos)for(var j in original.attrs)original.attrs[j]&&atributos[i]&&original.attrs[j].id===atributos[i].id&&(atributos[i]=original.attrs[j])}vm.produto.atributos=atributos})},vm.produto.sku&&vm.load(),vm.loadLinhas(),vm.loadMarcas(),vm.linhaChange=function(){vm.produto.linha_id=vm.produto.linha.id,Linha.get(vm.produto.linha_id).then(function(linha){vm.produto.linha=linha,linha.ncm_padrao&&SweetAlert.swal({type:"info",title:"",html:!0,text:"O código NCM padrão desta linha é: <b>"+linha.ncm_padrao+"</b><br/>Deseja utilizá-lo?",showCancelButton:!0,cancelButtonText:"Não",confirmButtonColor:"#40D9CA",confirmButtonText:"Sim"},function(isConfirm){isConfirm&&(vm.produto.ncm=linha.ncm_padrao)})}),vm.loadAtributos()},vm.marcaChange=function(){vm.produto.marca_id=vm.produto.marca.id},vm.generateSku=function(){function generate(){Produto.generateSku(vm.sku.original).then(function(product){vm.produto.sku=product.sku,$state.go("app.produtos.form",{sku:product.sku},{notify:!1}),vm.sku.gerado=!0,toaster.pop("success","Sucesso!","Um novo SKU foi gerado para este produto!");for(var i in vm.produto.atributos)vm.produto.atributos[i]&&"object"==typeof vm.produto.atributos[i]&&vm.produto.atributos[i].id&&(vm.produto.atributos[i].pivot||(vm.produto.atributos[i].pivot={}),vm.produto.atributos[i].pivot.produto_sku=product.sku)})}vm.produto.sku?SweetAlert.swal({title:"Tem certeza?",text:"Esta ação não poderá ser desfeita!",type:"warning",showCancelButton:!0,cancelButtonText:"Não",confirmButtonColor:"#F55752",confirmButtonText:"Sim!"},function(isConfirm){isConfirm&&generate()}):generate()},vm.save=function(){function save(){Produto.save(vm.produto,vm.sku.gerado?vm.produto.sku:vm.sku.original).then(function(){toaster.pop("success","Sucesso!","Produto salvo com sucesso!"),$state.go("app.produtos.index")})}vm.sku.gerado||vm.sku.original==vm.produto.sku?save():Produto.checkSku(vm.produto.sku).then(function(response){response.exists?toaster.pop("error","SKU existente!","Impossível cadastrar produto! Utilize outro SKU!"):save()})},vm.destroy=function(){Produto.delete(vm.produto.sku).then(function(){toaster.pop("success","Sucesso!","Produto excluido com sucesso!"),$state.go("app.produtos.index")})}}angular.module("MeuTucano").controller("ProdutoFormController",ProdutoFormController)}(),function(){"use strict";function ProdutoListController(Filter,TableHeader,Produto){var vm=this;vm.filterList=Filter.init("produtos",vm,{"produtos.titulo":"LIKE","produtos.estoque":"BETWEEN"}),vm.tableHeader=TableHeader.init("produtos",vm),vm.load=function(){vm.loading=!0,Produto.getList({fields:["produtos.*"],filter:vm.filterList.parse(),page:vm.tableHeader.pagination.page,per_page:vm.tableHeader.pagination.per_page}).then(function(response){vm.tableData=response,vm.loading=!1})},vm.load()}angular.module("MeuTucano").controller("ProdutoListController",ProdutoListController)}(),function(){"use strict";function RelatorioPedidosController($window,$location,$anchorScroll,$httpParamSerializer,envService,toaster,Restangular){var vm=this;vm.dragControlListeners={clone:!1,allowDuplicates:!1,containment:"#horizontal-container",accept:function(sourceItemHandleScope,destSortableScope){return sourceItemHandleScope.itemScope.sortableScope.$id===destSortableScope.$id}},vm.result=!1,vm.groupedResult=!1,vm.totalResults=0,vm.labels=[],vm.gerar=function(tipo){if(vm.params.fields.length){var params={filter:vm.params.filter,group:vm.params.group,fields:vm.params.fields,order:vm.params.order,relation:vm.params.relation};if(tipo){var auth={token:localStorage.getItem("satellizer_token")};$window.open(envService.read("apiUrl")+"/relatorios/pedido/"+tipo+"?params="+JSON.stringify(params)+"&"+$httpParamSerializer(auth),"relatorio-pedido")}else vm.result=!1,vm.labels=[],Restangular.one("relatorios/pedido",tipo||null).customPOST(params).then(function(response){if(vm.groupedResult=!!vm.params.group,vm.result=Restangular.copy(response,vm.result),vm.result=angular.copy(response,vm.result),vm.totalResults=[],vm.groupedResult){vm.totalResults=vm.result.length,vm.totalResults=vm.totalResults+(1==vm.totalResults?" grupo encontrado":" grupos encontrados");for(var chave in vm.result[0].data[0])vm.labels.push(chave)}else{vm.totalResults=vm.result.length,vm.totalResults=vm.totalResults+(1==vm.totalResults?" registro encontrado":" registros encontrados");for(var key in vm.result[0])vm.labels.push(key)}$location.hash("relatorio-resultado"),$anchorScroll()})}else toaster.pop("warning","","Você precisa selecionar os campos antes de gerar o relatório!")},vm.defaults=function(){vm.result=!1,vm.labels=[],vm.list={},vm.list.cities={},vm.params={filter:[],group:"",fields:[{label:"Código marketplace",name:"codigo_marketplace"},{label:"Marketplace",
name:"marketplace"},{label:"Status",name:"status"},{label:"Total",name:"total"},{label:"Data de abertura",name:"created_at"}],order:[],relation:{cliente:!1,endereco:!1,produtos:!1}},vm.list.status={0:"Pendente",1:"Pago",2:"Enviado",3:"Entregue",5:"Cancelado"},vm.list.marketplace={b2w:"B2W",cnova:"CNOVA",mercadolivre:"Mercado Livre",walmart:"Walmart",site:"Site"},vm.list.fields={},vm.list.fields.pedido={codigo_api:"Código",frete_valor:"Frete valor",frete_metodo:"Frete método",pagamento_metodo:"Pagamento método",codigo_marketplace:"Código marketplace",marketplace:"Marketplace",operacao:"Operação",total:"Total",estimated_delivery:"Entrega estimada",status:"Status",protocolo:"Protocolo cancelamento",segurado:"Segurado",reembolso:"Reembolso",priorizado:"Priorizado",created_at:"Data de abertura"},vm.list.fields.cliente={"cliente.nome":"Nome","cliente.taxvat":"Documento","cliente.fone":"Telefone","cliente.email":"E-mail"},vm.list.fields.endereco={"endereco.rua":"Rua","endereco.numero":"Número","endereco.bairro":"Bairro","endereco.complemento":"Complemento","endereco.cidade":"Cidade","endereco.uf":"UF","endereco.cep":"CEP"},vm.list.fields.produto={"produtos.titulo":"Título","pedido_produtos.produto_sku":"SKU","pedido_produtos.imei":"IMEI","pedido_produtos.quantidade":"Quantidade","pedido_produtos.valor":"Valor"},vm.list.fields.all=_.extend(vm.list.fields.all,vm.list.fields.pedido),vm.list.fields.all=_.extend(vm.list.fields.all,vm.list.fields.cliente),vm.list.fields.all=_.extend(vm.list.fields.all,vm.list.fields.endereco),vm.list.fields.all=_.extend(vm.list.fields.all,vm.list.fields.produto),vm.params.filter={total:{operator:"BETWEEN"},"pedidos.created_at":{operator:"BETWEEN"},estimated_delivery:{operator:"BETWEEN"},status:{operator:"IN",value:{}},marketplace:{operator:"IN",value:{}},"cliente_enderecos.uf":"","cliente_enderecos.cidade":"","pedido_produtos.produto_sku":{operator:"LIKE"},"pedido_produtos.imei":{operator:"LIKE"},"pedido_produtos.quantidade":{operator:"BETWEEN"},"pedido_produtos.valor":{operator:"BETWEEN"}},vm.setFilters={status:"",marketplace:""},vm.setField="",vm.setOrder=""},vm.limpar=function(){vm.defaults(),$location.hash(""),$anchorScroll()},vm.load=function(){vm.defaults()},vm.load(),vm.loadCities=function(){vm.params.filter["cliente_enderecos.cidade"]="","undefined"!=typeof vm.params.filter["cliente_enderecos.uf"].value&&vm.params.filter["cliente_enderecos.uf"].value&&Restangular.one("pedidos/cidades",vm.params.filter["cliente_enderecos.uf"].value).getList().then(function(response){vm.list.cities=response})},vm.changeRelation=function(){vm.params.relation.endereco!==!0&&(vm.params.filter["cliente_enderecos.uf"]="",vm.params.filter["cliente_enderecos.cidade"]=""),vm.params.relation.produtos!==!0&&(vm.params.filter["pedido_produtos.produto_sku"]={operator:"LIKE"},vm.params.filter["pedido_produtos.imei"]={operator:"LIKE"},vm.params.filter["pedido_produtos.quantidade"]={operator:"BETWEEN"},vm.params.filter["pedido_produtos.valor"]={operator:"BETWEEN"})},vm.addFilter=function(key){vm.params.filter[key].value[vm.setFilters[key]]=vm.list[key][vm.setFilters[key]],vm.setFilters[key]=""},vm.removeFilter=function(key,index){delete vm.params.filter[key].value[index]},vm.addOrder=function(){var exists=_.some(vm.params.order,function(p){return p.name==vm.setOrder});exists||vm.params.order.push({label:vm.list.fields.all[vm.setOrder],name:vm.setOrder,order:"asc"}),vm.setOrder=""},vm.changeOrder=function(index){vm.params.order[index].order="asc"==vm.params.order[index].order?"desc":"asc"},vm.removeOrder=function(index){delete vm.params.order[index],vm.params.order=_.compact(vm.params.order)},vm.addField=function(){var exists=_.some(vm.params.fields,function(p){return p.name==vm.setField});exists||vm.params.fields.push({label:vm.list.fields.all[vm.setField],name:vm.setField}),vm.setField=""},vm.removeField=function(index){delete vm.params.fields[index],vm.params.fields=_.compact(vm.params.fields)}}angular.module("MeuTucano").controller("RelatorioPedidosController",RelatorioPedidosController)}(),function(){"use strict";function RelatorioProdutosController($window,$location,$anchorScroll,$httpParamSerializer,envService,toaster,Restangular){var vm=this;vm.dragControlListeners={clone:!1,allowDuplicates:!1,containment:"#horizontal-container",accept:function(sourceItemHandleScope,destSortableScope){return sourceItemHandleScope.itemScope.sortableScope.$id===destSortableScope.$id}},vm.result=!1,vm.labels=[],vm.groupedResult=!1,vm.totalResults=0,vm.gerar=function(tipo){if(vm.params.fields.length){var params={filter:vm.params.filter,group:vm.params.group,fields:vm.params.fields,order:vm.params.order,relation:vm.params.relation};if(tipo){var auth={token:localStorage.getItem("satellizer_token")};$window.open(envService.read("apiUrl")+"/relatorios/produto/"+tipo+"?params="+JSON.stringify(params)+"&"+$httpParamSerializer(auth),"relatorio-produto")}else vm.result=!1,vm.labels=[],Restangular.one("relatorios/produto",tipo||null).customPOST(params).then(function(response){if(vm.groupedResult=!!vm.params.group,vm.result=Restangular.copy(response,vm.result),vm.result=angular.copy(response,vm.result),vm.totalResults=[],vm.groupedResult){vm.totalResults=vm.result.length,vm.totalResults=vm.totalResults+(1==vm.totalResults?" grupo encontrado":" grupos encontrados");for(var chave in vm.result[0].data[0])vm.labels.push(chave)}else{vm.totalResults=vm.result.length,vm.totalResults=vm.totalResults+(1==vm.totalResults?" registro encontrado":" registros encontrados");for(var key in vm.result[0])vm.labels.push(key)}$location.hash("relatorio-resultado"),$anchorScroll()})}else toaster.pop("warning","","Você precisa selecionar os campos antes de gerar o relatório!")},vm.defaults=function(){vm.result=!1,vm.labels=[],vm.params={filter:[],group:"",fields:[{label:"Título",name:"titulo"},{label:"SKU",name:"sku"},{label:"Estoque",name:"estoque"},{label:"Data de criação",name:"created_at"}],order:[],relation:{pedido:!1}},vm.list={},vm.list["pedidos.status"]={0:"Pendente",1:"Pago",2:"Enviado",3:"Entregue",5:"Cancelado"},vm.list["pedidos.marketplace"]={b2w:"B2W",cnova:"CNOVA",mercadolivre:"Mercado Livre",walmart:"Walmart",site:"Site"},vm.list.fields={},vm.list.fields.produto={titulo:"Título",sku:"SKU",estoque:"Estoque",created_at:"Data de criação"},vm.list.fields.pedido={"pedido_produtos.quantidade":"Quantidade","pedido_produtos.valor":"Valor do produto","pedidos.codigo_marketplace":"Código marketplace","pedidos.marketplace":"Marketplace","pedidos.status":"Status","pedidos.total":"Valor total","pedidos.estimated_delivery":"Entrega estimada","pedidos.created_at":"Data do pedido"},vm.list.fields.all=_.extend(vm.list.fields.all,vm.list.fields.produto),vm.list.fields.all=_.extend(vm.list.fields.all,vm.list.fields.pedido),vm.params.filter={sku:{operator:"LIKE"},titulo:{operator:"LIKE"},estoque:{operator:"BETWEEN"},"produtos.created_at":{operator:"BETWEEN"},"pedido_produtos.imei":{operator:"LIKE"},"pedido_produtos.quantidade":{operator:"BETWEEN"},"pedido_produtos.valor":{operator:"BETWEEN"},"pedidos.marketplace":{operator:"IN",value:{}},"pedidos.status":{operator:"IN",value:{}},"pedidos.total":{operator:"BETWEEN"},"pedidos.created_at":{operator:"BETWEEN"},"pedidos.estimated_delivery":{operator:"BETWEEN"}},vm.setFilters={"pedidos.status":"","pedidos.marketplace":""},vm.setField="",vm.setOrder=""},vm.limpar=function(){vm.defaults(),$location.hash(""),$anchorScroll()},vm.load=function(){vm.defaults()},vm.load(),vm.changeRelation=function(){vm.params.relation.pedido!==!0&&(vm.params.filter["pedido_produtos.quantidade"]={operator:"BETWEEN"},vm.params.filter["pedido_produtos.valor"]={operator:"BETWEEN"},vm.params.filter["pedidos.marketplace"]={operator:"IN",value:{}},vm.params.filter["pedidos.status"]={operator:"IN",value:{}},vm.params.filter["pedidos.total"]={operator:"BETWEEN"},vm.params.filter["pedidos.created_at"]={operator:"BETWEEN"},vm.params.filter["pedidos.estimated_delivery"]={operator:"BETWEEN"})},vm.addFilter=function(key){vm.params.filter[key].value[vm.setFilters[key]]=vm.list[key][vm.setFilters[key]],vm.setFilters[key]=""},vm.removeFilter=function(key,index){delete vm.params.filter[key].value[index]},vm.addOrder=function(){var exists=_.some(vm.params.order,function(p){return p.name==vm.setOrder});exists||vm.params.order.push({label:vm.list.fields.all[vm.setOrder],name:vm.setOrder,order:"asc"}),vm.setOrder=""},vm.changeOrder=function(index){vm.params.order[index].order="asc"==vm.params.order[index].order?"desc":"asc"},vm.removeOrder=function(index){delete vm.params.order[index],vm.params.order=_.compact(vm.params.order)},vm.addField=function(){var exists=_.some(vm.params.fields,function(p){return p.name==vm.setField});exists||vm.params.fields.push({label:vm.list.fields.all[vm.setField],name:vm.setField}),vm.setField=""},vm.removeField=function(index){delete vm.params.fields[index],vm.params.fields=_.compact(vm.params.fields)}}angular.module("MeuTucano").controller("RelatorioProdutosController",RelatorioProdutosController)}(),function(){"use strict";function SugestaoDetalheController($scope,toaster,Sugestao,Usuario){var vm=this;vm.sugestao=angular.copy($scope.ngDialogData.sugestao),vm.arquivar=function(){vm.sugestao.status=2,vm.save()},vm.aceitar=function(){vm.sugestao.status=1,vm.save()},vm.save=function(){Sugestao.save(vm.sugestao,vm.sugestao.id).then(function(){toaster.pop("success","Sucesso!","Sugestão / crítica salva com sucesso!"),$scope.closeThisDialog(!0)})}}angular.module("MeuTucano").controller("SugestaoDetalheController",SugestaoDetalheController)}(),function(){"use strict";function SugestaoFormController($scope,toaster,Sugestao,Usuario){var vm=this;vm.pessoas={},vm.sugestao={},vm.load=function(){Usuario.getList().then(function(response){vm.pessoas=response})},vm.load(),vm.save=function(){Sugestao.save(vm.sugestao).then(function(){toaster.pop("success","Sucesso!","Sugestão / crítica enviada com sucesso!"),$scope.closeThisDialog(!0)})}}angular.module("MeuTucano").controller("SugestaoFormController",SugestaoFormController)}(),function(){"use strict";function SugestaoListController(Usuario,Sugestao,Filter,TableHeader,ngDialog){var vm=this;vm.usuarios={},vm.filterList=Filter.init("sugestoes",vm,{"sugestoes.created_at":"BETWEEN"}),vm.tableHeader=TableHeader.init("sugestoes",vm),vm.loadUsuarios=function(){vm.loading=!0,Usuario.getList().then(function(response){vm.usuarios=response.data,vm.loading=!1})},vm.load=function(){vm.loading=!0,Sugestao.getList({fields:["sugestoes.*"],filter:vm.filterList.parse(),page:vm.tableHeader.pagination.page,per_page:vm.tableHeader.pagination.per_page}).then(function(response){vm.tableData=response,vm.loading=!1,vm.loadUsuarios()})},vm.load(),vm.parseStatusClass=function(status){return 1==status?"success":2==status?"warning":void 0},vm.openForm=function(sugestao){ngDialog.open({template:"views/sugestoes/detalhe.html",controller:"SugestaoDetalheController",controllerAs:"SugestaoDetalhe",data:{sugestao:sugestao||{}}}).closePromise.then(function(data){data.value===!0&&vm.load()})}}angular.module("MeuTucano").controller("SugestaoListController",SugestaoListController)}(),function(){"use strict";function UsuarioFormController(Usuario,$rootScope,$scope,toaster){var vm=this;vm.usuario=angular.copy($scope.ngDialogData.usuario),vm.usuario.novasRoles=[],vm.usuario.hasOwnProperty("roles")&&angular.forEach(vm.usuario.roles,function(role){vm.usuario.novasRoles[role.id]=role.id}),vm.save=function(){Usuario.save(vm.usuario,vm.usuario.id||null).then(function(){toaster.pop("success","Sucesso!","Usuário salvo com sucesso!"),$scope.closeThisDialog(!0)})}}angular.module("MeuTucano").controller("UsuarioFormController",UsuarioFormController)}(),function(){"use strict";function UsuarioListController(Usuario,TableHeader,ngDialog,toaster){var vm=this;vm.tableHeader=TableHeader.init("usuarios",vm),vm.load=function(){vm.loading=!0,Usuario.getList({page:vm.tableHeader.pagination.page,per_page:vm.tableHeader.pagination.per_page}).then(function(response){vm.tableData=response,vm.loading=!1})},vm.load(),vm.openForm=function(usuario){ngDialog.open({template:"views/usuario/form.html",controller:"UsuarioFormController",controllerAs:"UsuarioForm",data:{usuario:usuario||{}}}).closePromise.then(function(data){data.value===!0&&vm.load()})},vm.destroy=function(id){Usuario.delete(id).then(function(){toaster.pop("success","Sucesso!","Usuário deletado com sucesso!"),vm.load()})}}angular.module("MeuTucano").controller("UsuarioListController",UsuarioListController)}(),function(){"use strict";function ClienteModel(Rest,Restangular){var rest=angular.copy(Rest);return rest.baseUrl="clientes",angular.extend(rest,{detail:function(params){return params=this.parseParams(params),Restangular.all("clientes/detail").customGET(params||{})},changeEmail:function(cliente_id,email){return Restangular.one("clientes/email/"+cliente_id).customPUT({email:email})}}),rest}angular.module("MeuTucano").service("Cliente",ClienteModel)}(),function(){"use strict";function EnderecoModel(Rest,Restangular){var rest=angular.copy(Rest);return rest.baseUrl="enderecos",rest}angular.module("MeuTucano").service("Endereco",EnderecoModel)}(),function(){"use strict";function ConquistaModel(Rest){var rest=angular.copy(Rest);return rest.baseUrl="gamification/conquistas",rest}angular.module("MeuTucano").service("Conquista",ConquistaModel)}(),function(){"use strict";function GamificationModel(Restangular){var baseUrl="gamification";return{perfil:function(usuario_id){return Restangular.one(baseUrl+"/perfil",usuario_id||null).customGET()},ranking:function(){return Restangular.one(baseUrl+"/ranking").customGET()},avatar:function(gamification_id,avatar){return Restangular.one(baseUrl+"/avatar",gamification_id).customPOST({avatar:avatar})}}}angular.module("MeuTucano").service("Gamification",GamificationModel)}(),function(){"use strict";function TarefaModel(Rest){var rest=angular.copy(Rest);return rest.baseUrl="gamification/tarefas",rest}angular.module("MeuTucano").service("Tarefa",TarefaModel)}(),function(){"use strict";function VotoModel(Rest){var rest=angular.copy(Rest);return rest.baseUrl="gamification/votos",rest}angular.module("MeuTucano").service("Voto",VotoModel)}(),function(){"use strict";function InspecaoTecnicaModel(Rest,Restangular){var rest=angular.copy(Rest);return rest.baseUrl="inspecao_tecnica",angular.extend(rest,{fila:function(params){return params=this.parseParams(params),Restangular.all(this.baseUrl+"/fila").customGET("",params||{})},solicitadas:function(params){return params=this.parseParams(params),Restangular.all(this.baseUrl+"/solicitadas").customGET("",params||{})},alterarPrioridade:function(pedido_produtos_id){return Restangular.one(this.baseUrl+"/priority",pedido_produtos_id).customPOST()},reserva:function(params){return Restangular.all(this.baseUrl+"/reserva").post(params)},verificarReserva:function(params){return Restangular.all(this.baseUrl+"/verificar-reserva").post(params)}}),rest}angular.module("MeuTucano").service("InspecaoTecnica",InspecaoTecnicaModel)}(),function(){"use strict";function ComentarioModel(Rest,Restangular){var rest=angular.copy(Rest);return rest.baseUrl="comentarios",angular.extend(rest,{getFromOrder:function(params){return params=this.parseParams(params),Restangular.all("comentarios").customGET(params||{})}}),rest}angular.module("MeuTucano").service("Comentario",ComentarioModel)}(),function(){"use strict";function PedidoModel(Rest,Restangular){var rest=angular.copy(Rest);return rest.baseUrl="pedidos",angular.extend(rest,{faturamento:function(params){return params=this.parseParams(params),Restangular.all("pedidos/faturamento").customGET("",params||{})},status:function(pedido_id,params){return params=this.parseParams(params),Restangular.one("pedidos/status",pedido_id).customPUT(params||{})},segurar:function(pedido_id,segurar){return Restangular.one("pedidos/segurar",pedido_id).customPUT({segurar:segurar})},prioridade:function(pedido_id,priorizado){return Restangular.one("pedidos/prioridade",pedido_id).customPUT({priorizado:priorizado})},faturar:function(pedido_id){return Restangular.one("pedidos/faturar",pedido_id).get()},totalOrdersStatus:function(){return Restangular.one("pedidos/total-orders-status").get()},totalOrdersDate:function(){return Restangular.one("pedidos/total-orders-date").get()},totalOrders:function(mes,ano){mes="undefined"!=typeof mes&&!isNaN(parseInt(mes))&&parseInt(mes),ano="undefined"!=typeof ano&&!isNaN(parseInt(ano))&&parseInt(ano);var string="";return string=mes?"/"+mes:"",string+=ano?"/"+ano:"",Restangular.one("pedidos/total-orders"+string).get()}}),rest}angular.module("MeuTucano").service("Pedido",PedidoModel)}(),function(){"use strict";function RastreioModel(Rest,Restangular){var rest=angular.copy(Rest);return rest.baseUrl="rastreios",angular.extend(rest,{important:function(params){return params=this.parseParams(params),Restangular.all("rastreios/important").customGET("",params||{})},refreshAll:function(){return Restangular.all("rastreios/refresh_all").customPUT()},historico:function(rastreio_id){return Restangular.one("rastreios/historico/",rastreio_id).customPUT()},codigo:function(servico){return Restangular.one("codigos/gerar",servico).customGET()},monitorar:function(rastreio_id,monitorar){return monitorar?Restangular.one("rastreio/monitorados").customPOST({rastreio_id:rastreio_id}):Restangular.one("rastreio/monitorados/parar",rastreio_id).customDELETE()},getInspecaoData:function(rastreio_id){return Restangular.one("rastreios/inspecao-tecnica",rastreio_id).customGET()},existsSeminovos:function(rastreio_id){return Restangular.one("rastreios/busca-seminovos",rastreio_id).customGET()}}),rest}angular.module("MeuTucano").service("Rastreio",RastreioModel)}(),function(){"use strict";function AtributoModel(Rest,Restangular){var rest=angular.copy(Rest);return rest.baseUrl="atributos",angular.extend(rest,{fromLinha:function(params){return params=this.parseParams(params),Restangular.all("atributos/linha").customGET(params||{})}}),rest}angular.module("MeuTucano").service("Atributo",AtributoModel)}(),function(){"use strict";function MarcaModel(Rest){var rest=angular.copy(Rest);return rest.baseUrl="marcas",rest}angular.module("MeuTucano").service("Marca",MarcaModel)}(),function(){"use strict";function ProdutoModel(Rest,Restangular){var rest=angular.copy(Rest);return rest.baseUrl="produtos",angular.extend(rest,{generateSku:function(sku){return Restangular.one(rest.baseUrl+"/generate-sku").customGET(sku||null)},checkSku:function(sku){return Restangular.one(rest.baseUrl+"/check-sku").customGET(sku)},search:function(term,estado){return estado="undefined"!=typeof estado&&estado?"?estado="+estado:"",Restangular.one(rest.baseUrl+"/search/"+term+estado).customGET()}}),rest}angular.module("MeuTucano").service("Produto",ProdutoModel)}(),function(){"use strict";function SugestaoModel(Rest){var rest=angular.copy(Rest);return rest.baseUrl="sugestoes",rest}angular.module("MeuTucano").service("Sugestao",SugestaoModel)}(),function(){"use strict";function SenhaModel(Rest,Restangular){var rest=angular.copy(Rest);return rest.baseUrl="senhas",angular.extend(rest,{fromUser:function(id,params){return id?Restangular.one("senhas",id||0).customGET("",params||{}):Restangular.one("senhas/minhas").customGET("",params||{})}}),rest}angular.module("MeuTucano").service("Senha",SenhaModel)}(),function(){"use strict";function UsuarioModel(Rest){var rest=angular.copy(Rest);return rest.baseUrl="usuarios",rest}angular.module("MeuTucano").service("Usuario",UsuarioModel)}(),function(){"use strict";function EnderecoFormController(Endereco,$scope,toaster){var vm=this;vm.endereco=angular.copy($scope.ngDialogData.endereco),vm.save=function(){Endereco.save(vm.endereco,vm.endereco.id||null).then(function(){toaster.pop("success","Sucesso!","Endereço salvo com sucesso!"),$scope.closeThisDialog(!0)})}}angular.module("MeuTucano").controller("EnderecoFormController",EnderecoFormController)}(),function(){"use strict";function ConquistaFormController($scope,toaster,envService,Upload,Conquista,Tarefa){var vm=this;"undefined"!=typeof $scope.ngDialogData.conquista?vm.conquista=angular.copy($scope.ngDialogData.conquista):vm.conquista={},vm.imagem=null,vm.tarefas={},vm.tempoOptions=["No mesmo dia","Na mesma semana","No mesmo mês","Tempo indeterminado"],vm.load=function(){vm.loading=!0,Conquista.get(vm.conquista.id).then(function(conquista){vm.conquista=conquista,vm.loading=!1})},vm.conquista.id&&vm.load(),vm.loadTarefas=function(){Tarefa.getList().then(function(response){vm.tarefas=response.data})},vm.loadTarefas(),vm.save=function(){vm.conquista.icone?null===vm.imagem?Conquista.save(vm.conquista,vm.conquista.id||null).then(function(){toaster.pop("success","Sucesso!","Conquista salva com sucesso!"),$scope.closeThisDialog(!0)}):Upload.upload({url:envService.read("apiUrl")+"/gamification/upload",headers:{Authorization:"Bearer "+localStorage.getItem("satellizer_token")},data:{arquivo:Upload.dataUrltoBlob(vm.conquista.icone,vm.imagem.name)}}).success(function(response){toaster.pop("success","Upload concluído",response.data.msg),vm.conquista.icone=response.data,Conquista.save(vm.conquista,vm.conquista.id||null).then(function(){toaster.pop("success","Sucesso!","Conquista salva com sucesso!"),$scope.closeThisDialog(!0)})}).error(function(){toaster.pop("error","Erro no upload!","Erro ao enviar arquivos, tente novamente!")}):toaster.pop("error","Erro no upload!","Tem certeza que você selecionou uma imagem?")},vm.destroy=function(){Conquista.delete(vm.conquista.id).then(function(){toaster.pop("success","Sucesso!","Conquista excluida com sucesso!"),$scope.closeThisDialog(!0)})}}angular.module("MeuTucano").controller("ConquistaFormController",ConquistaFormController)}(),function(){"use strict";function ConquistaListController(ngDialog,Filter,TableHeader,Conquista){var vm=this;vm.filterList=Filter.init("conquistas",vm,{"gamification_conquistas.titulo":"LIKE"}),vm.tableHeader=TableHeader.init("gamification_conquistas",vm),vm.load=function(){vm.loading=!0,Conquista.getList({fields:["gamification_conquistas.*"],filter:vm.filterList.parse(),page:vm.tableHeader.pagination.page,per_page:vm.tableHeader.pagination.per_page}).then(function(response){vm.tableData=response,vm.loading=!1})},vm.load(),vm.openForm=function(conquista){ngDialog.open({template:"views/gamification/conquistas/form.html",controller:"ConquistaFormController",controllerAs:"ConquistaForm",data:{conquista:conquista||{}}}).closePromise.then(function(data){data.value===!0&&vm.load()})}}angular.module("MeuTucano").controller("ConquistaListController",ConquistaListController)}(),function(){"use strict";function TarefaFormController($scope,toaster,Tarefa){var vm=this;"undefined"!=typeof $scope.ngDialogData.tarefa?vm.tarefa=angular.copy($scope.ngDialogData.tarefa):vm.tarefa={},vm.load=function(){vm.loading=!0,Tarefa.get(vm.tarefa.id).then(function(tarefa){vm.tarefa=tarefa,vm.loading=!1})},vm.tarefa.id&&vm.load(),vm.save=function(){Tarefa.save(vm.tarefa,vm.tarefa.id||null).then(function(){toaster.pop("success","Sucesso!","Tarefa salva com sucesso!"),$scope.closeThisDialog(!0)})},vm.destroy=function(){Tarefa.delete(vm.tarefa.id).then(function(){toaster.pop("success","Sucesso!","Tarefa excluida com sucesso!"),$scope.closeThisDialog(!0)})}}angular.module("MeuTucano").controller("TarefaFormController",TarefaFormController)}(),function(){"use strict";function TarefaListController(ngDialog,Filter,TableHeader,Tarefa){var vm=this;vm.filterList=Filter.init("tarefas",vm,{"gamification_tarefas.titulo":"LIKE"}),vm.tableHeader=TableHeader.init("gamification_tarefas",vm),vm.load=function(){vm.loading=!0,Tarefa.getList({fields:["gamification_tarefas.*"],filter:vm.filterList.parse(),page:vm.tableHeader.pagination.page,per_page:vm.tableHeader.pagination.per_page}).then(function(response){vm.tableData=response,vm.loading=!1})},vm.load(),vm.openForm=function(tarefa){ngDialog.open({template:"views/gamification/tarefas/form.html",controller:"TarefaFormController",controllerAs:"TarefaForm",data:{tarefa:tarefa||{}}}).closePromise.then(function(data){data.value===!0&&vm.load()})}}angular.module("MeuTucano").controller("TarefaListController",TarefaListController)}(),function(){"use strict";function EditarController(Restangular,$rootScope,$scope,toaster,Rastreio){var vm=this;"undefined"!=typeof $scope.ngDialogData.rastreio?vm.rastreio=$scope.ngDialogData.rastreio:vm.rastreio={},vm.save=function(){Rastreio.save(vm.rastreio,vm.rastreio.id||null).then(function(){$scope.closeThisDialog(!0),toaster.pop("success","Sucesso!","Pedido editado com sucesso!")})}}angular.module("MeuTucano").controller("EditarController",EditarController)}(),function(){"use strict";function RastreioImportanteListController(Rastreio,Filter,TableHeader,toaster){var vm=this;vm.filterList=Filter.init("rastreios",vm,{"pedidos.codigo_marketplace":"LIKE","clientes.nome":"LIKE","pedido_rastreios.rastreio":"LIKE"}),vm.tableHeader=TableHeader.init("rastreios",vm),vm.load=function(){vm.loading=!0,Rastreio.important({fields:["pedido_rastreios.*"],filter:vm.filterList.parse(),page:vm.tableHeader.pagination.page,per_page:vm.tableHeader.pagination.per_page}).then(function(response){vm.tableData=response,vm.loading=!1})},vm.load()}angular.module("MeuTucano").controller("RastreioImportanteListController",RastreioImportanteListController)}(),function(){"use strict";function LinhaFormController($rootScope,$state,$stateParams,Restangular,Linha,toaster,ngDialog){var vm=this;vm.linha={id:$stateParams.id||null,atributos:[],removidos:{atributos:[],opcoes:[]}},vm.load=function(){vm.loading=!0,Linha.get(vm.linha.id).then(function(linha){vm.linha=linha,vm.loading=!1,vm.linha.removidos={atributos:[],opcoes:[]}})},vm.linha.id&&vm.load(),vm.addAttribute=function(){vm.linha.atributos.unshift({})},vm.removeAttribute=function(index){vm.linha.removidos.atributos.push(vm.linha.atributos[index].id),vm.linha.atributos.splice(index,1)},vm.removeTag=function(tag){vm.linha.removidos.opcoes.push(tag.id)},vm.checkTag=function(tag,index){tag&&(tag.id=null,vm.linha.atributos[index].opcoes.push(tag))},vm.save=function(){Linha.save(vm.linha,vm.linha.id||null).then(function(){toaster.pop("success","Sucesso!","Linha salva com sucesso!"),$state.go("app.produtos.linhas.index")})},vm.destroy=function(){Linha.delete(vm.linha.id).then(function(){toaster.pop("success","Sucesso!","Linha excluida com sucesso!"),$state.go("app.produtos.linhas.index")})}}angular.module("MeuTucano").controller("LinhaFormController",LinhaFormController)}(),function(){"use strict";function LinhaListController(Linha,Filter,TableHeader,ngDialog){var vm=this;vm.filterList=Filter.init("linhas",vm,{"linhas.titulo":"LIKE"}),vm.tableHeader=TableHeader.init("linhas",vm),vm.load=function(){vm.loading=!0,Linha.getList({fields:["linhas.*"],filter:vm.filterList.parse(),page:vm.tableHeader.pagination.page,per_page:vm.tableHeader.pagination.per_page}).then(function(response){vm.tableData=response,vm.loading=!1})},vm.load()}angular.module("MeuTucano").controller("LinhaListController",LinhaListController)}(),function(){"use strict";function MarcaFormController($rootScope,$scope,$state,$stateParams,Marca,toaster){var vm=this;"undefined"!=typeof $scope.ngDialogData.marca?vm.marca=angular.copy($scope.ngDialogData.marca):vm.marca={},vm.load=function(){vm.loading=!0,Marca.get(vm.marca.id).then(function(marca){vm.marca=marca,vm.loading=!1})},vm.marca.id&&vm.load(),vm.save=function(){Marca.save(vm.marca,vm.marca.id||null).then(function(){toaster.pop("success","Sucesso!","Marca salva com sucesso!"),$scope.closeThisDialog(!0)})},vm.destroy=function(){Marca.delete(vm.marca.id).then(function(){toaster.pop("success","Sucesso!","Marca excluida com sucesso!"),$scope.closeThisDialog(!0)})}}angular.module("MeuTucano").controller("MarcaFormController",MarcaFormController)}(),function(){"use strict";function MarcaListController(Marca,Filter,TableHeader,ngDialog){var vm=this;vm.filterList=Filter.init("marcas",vm,{"marcas.titulo":"LIKE"}),vm.tableHeader=TableHeader.init("marcas",vm),vm.load=function(){vm.loading=!0,Marca.getList({fields:["marcas.*"],filter:vm.filterList.parse(),page:vm.tableHeader.pagination.page,per_page:vm.tableHeader.pagination.per_page}).then(function(response){vm.tableData=response,vm.loading=!1})},vm.load(),vm.openForm=function(marca){ngDialog.open({template:"views/produto/marca/form.html",controller:"MarcaFormController",controllerAs:"MarcaForm",data:{marca:marca||{}}}).closePromise.then(function(data){data.value===!0&&vm.load()})}}angular.module("MeuTucano").controller("MarcaListController",MarcaListController)}(),function(){"use strict";function MinhaSenhaController($rootScope,Restangular,ngDialog,toaster,Senha,TableHeader){var vm=this;vm.tableHeader=TableHeader.init("senhas",vm),vm.load=function(){ngDialog.open({template:"views/usuario/senha/form_senha.html"}).closePromise.then(function(data){null!==data.value&&(vm.loading=!0,Restangular.one("check-password",$rootScope.currentUser.id).customPOST({password:data.value}).then(function(response){vm.loading=!1,response===!0?(vm.loading=!0,Senha.fromUser(null,{page:vm.tableHeader.pagination.page,per_page:vm.tableHeader.pagination.per_page}).then(function(response){vm.tableData=response,vm.loading=!1})):(vm.tableData={},toaster.pop("error","Senhas não conferem!","Você não poderá visualizar essas informações!"))}))})},vm.load(),vm.toglePassword=function(index){"text"==vm.tableData.data[index].inputType?vm.tableData.data[index].inputType="password":vm.tableData.data[index].inputType="text"}}angular.module("MeuTucano").controller("MinhaSenhaController",MinhaSenhaController)}(),function(){"use strict";function SenhaFormController(Senha,$scope,toaster){var vm=this;vm.senha=angular.copy($scope.ngDialogData.senha),vm.save=function(){Senha.save(vm.senha,vm.senha.id||null).then(function(){toaster.pop("success","Sucesso!","Senha salva com sucesso!"),$scope.closeThisDialog(!0)})}}angular.module("MeuTucano").controller("SenhaFormController",SenhaFormController)}(),function(){"use strict";function SenhaListController(Senha,TableHeader,$stateParams,Restangular,ngDialog,toaster){var vm=this;vm.tableHeader=TableHeader.init("senhas",vm),vm.load=function(){vm.loading=!0,Senha.fromUser($stateParams.id,{page:vm.tableHeader.pagination.page,per_page:vm.tableHeader.pagination.per_page}).then(function(response){vm.tableData=response,vm.loading=!1})},vm.load(),vm.openForm=function(senha){ngDialog.open({template:"views/usuario/senha/form.html",controller:"SenhaFormController",controllerAs:"SenhaForm",data:{senha:senha||{usuario_id:$stateParams.id}}}).closePromise.then(function(data){data.value===!0&&vm.load()})},vm.destroy=function(id){Senha.delete(id).then(function(){toaster.pop("success","Sucesso!","Senha deletada com sucesso!"),vm.load()})},vm.toglePassword=function(index){"text"==vm.tableData.data[index].inputType?vm.tableData.data[index].inputType="password":vm.tableData.data[index].inputType="text"}}angular.module("MeuTucano").controller("SenhaListController",SenhaListController)}(),function(){"use strict";function Devolucao(Rest,Restangular){var rest=angular.copy(Rest);return rest.baseUrl="devolucoes",angular.extend(rest,{pending:function(params){return params=this.parseParams(params),Restangular.all("devolucoes/pending").customGET("",params||{})}}),rest}angular.module("MeuTucano").service("Devolucao",Devolucao)}(),function(){"use strict";function LogisticaModel(Rest,Restangular){var rest=angular.copy(Rest);return rest.baseUrl="logisticas",rest}angular.module("MeuTucano").service("Logistica",LogisticaModel)}(),function(){"use strict";function MonitoradoModel(Rest,Restangular){var rest=angular.copy(Rest);return rest.baseUrl="rastreio/monitorados",angular.extend(rest,{simpleList:function(){return Restangular.all(this.baseUrl+"/simple-list").customGET()}}),rest}angular.module("MeuTucano").service("Monitorado",MonitoradoModel)}(),function(){"use strict";function PiModel(Rest,Restangular){
var rest=angular.copy(Rest);return rest.baseUrl="pis",angular.extend(rest,{pending:function(params){return params=this.parseParams(params),Restangular.all("pis/pending").customGET("",params||{})}}),rest}angular.module("MeuTucano").service("Pi",PiModel)}(),function(){"use strict";function LinhaModel(Rest){var rest=angular.copy(Rest);return rest.baseUrl="linhas",rest}angular.module("MeuTucano").service("Linha",LinhaModel)}(),function(){"use strict";function DevolucaoFormController($scope,toaster,InspecaoTecnicaHelper,Devolucao){var vm=this;vm.devolucaoOriginal=angular.copy($scope.ngDialogData.devolucao,vm.devolucaoOriginal),vm.devolucao=$scope.ngDialogData.devolucao,vm.inspecaoTecnicaHelper=InspecaoTecnicaHelper.init(vm),vm.verifySeminovos=function(){vm.devolucaoOriginal.motivo===vm.devolucao.motivo&&vm.devolucaoOriginal.acao===vm.devolucao.acao||"5"!=vm.devolucao.motivo||"0"!=vm.devolucao.acao?vm.existsSeminovos=!1:vm.inspecaoTecnicaHelper.existsSeminovos(vm.devolucao.rastreio_id)},vm.save=function(){1==vm.existsSeminovos&&vm.inspecoes===!1?toaster.pop("warning","Atenção!","Este pedido possui produtos seminovos, antes de reenviar, você precisa requisitar as inspeções técnicas!"):(vm.existsSeminovos&&(vm.devolucao.inspecoes={criar:vm.inspecoes.criar,reservar:vm.inspecoes.reservar}),Devolucao.save(vm.devolucao,vm.devolucao.id||null).then(function(){toaster.pop("success","Sucesso!","Devolução criada com sucesso!"),$scope.closeThisDialog(!0)}))}}angular.module("MeuTucano").controller("DevolucaoFormController",DevolucaoFormController)}(),function(){"use strict";function DevolucaoPendenteListController(Filter,TableHeader,Devolucao,RastreioHelper,toaster){var vm=this;vm.filterList=Filter.init("devolucoes",vm,{"clientes.nome":"LIKE","pedido_rastreios.rastreio":"LIKE","pedido_rastreio_devolucoes.codigo_devolucao":"LIKE","pedidos.id":"LIKE"}),vm.tableHeader=TableHeader.init("devolucoes",vm),vm.rastreioHelper=RastreioHelper.init(vm),vm.load=function(){vm.loading=!0,Devolucao.pending({fields:["pedido_rastreio_devolucoes.*"],filter:vm.filterList.parse(),page:vm.tableHeader.pagination.page,per_page:vm.tableHeader.pagination.per_page}).then(function(response){vm.tableData=response,vm.loading=!1})},vm.load()}angular.module("MeuTucano").controller("DevolucaoPendenteListController",DevolucaoPendenteListController)}(),function(){"use strict";function LogisticaFormController($scope,toaster,InspecaoTecnicaHelper,Logistica){var vm=this;vm.logisticaOriginal=angular.copy($scope.ngDialogData.logistica,vm.logisticaOriginal),vm.logistica=$scope.ngDialogData.logistica,vm.inspecaoTecnicaHelper=InspecaoTecnicaHelper.init(vm),vm.verifySeminovos=function(){vm.logisticaOriginal.motivo===vm.logistica.motivo&&vm.logisticaOriginal.acao===vm.logistica.acao||"0"!=vm.logistica.motivo||"0"!=vm.logistica.acao?vm.existsSeminovos=!1:vm.inspecaoTecnicaHelper.existsSeminovos(vm.logistica.rastreio_id)},vm.save=function(){1==vm.existsSeminovos&&vm.inspecoes===!1?toaster.pop("warning","Atenção!","Este pedido possui produtos seminovos, antes de reenviar, você precisa requisitar as inspeções técnicas!"):(vm.existsSeminovos&&(vm.logistica.inspecoes={criar:vm.inspecoes.criar,reservar:vm.inspecoes.reservar}),Logistica.save(vm.logistica,vm.logistica.id||null).then(function(){$scope.closeThisDialog(!0),toaster.pop("success","Sucesso!","Logistica reversa salva com sucesso!")}))}}angular.module("MeuTucano").controller("LogisticaFormController",LogisticaFormController)}(),function(){"use strict";function RastreioMonitoradoListController(Filter,TableHeader,RastreioHelper,Monitorado){var vm=this;vm.filterList=Filter.init("rastreios_monitorados",vm,{"pedidos.codigo_marketplace":"LIKE","clientes.nome":"LIKE","pedido_rastreios.rastreio":"LIKE"}),vm.tableHeader=TableHeader.init("rastreios_monitorados",vm),vm.rastreioHelper=RastreioHelper.init(vm),vm.load=function(){vm.loading=!0,Monitorado.getList({fields:["pedido_rastreio_monitorados.*"],filter:vm.filterList.parse(),page:vm.tableHeader.pagination.page,per_page:vm.tableHeader.pagination.per_page}).then(function(response){vm.tableData=response,vm.loading=!1})},vm.load()}angular.module("MeuTucano").controller("RastreioMonitoradoListController",RastreioMonitoradoListController)}(),function(){"use strict";function PiFormController(Pi,$scope,toaster,$window,$httpParamSerializer,envService){var vm=this;vm.pi=$scope.ngDialogData.pi,vm.save=function(){Pi.save(vm.pi,vm.pi.id||null).then(function(){$scope.closeThisDialog(!0),toaster.pop("success","Sucesso!","Pedido de informação salvo com sucesso!")})},vm.openPi=function(){var auth={token:localStorage.getItem("satellizer_token")};$window.open(envService.read("apiUrl")+"/rastreios/pi/"+vm.pi.rastreio_id+"?"+$httpParamSerializer(auth))}}angular.module("MeuTucano").controller("PiFormController",PiFormController)}(),function(){"use strict";function PiPendenteListController(Filter,TableHeader,Pi,ngDialog,toaster,RastreioHelper){var vm=this;vm.filterList=Filter.init("pis",vm,{"clientes.nome":"LIKE","pedido_rastreios.rastreio":"LIKE","pedidos.codigo_marketplace":"LIKE","pedido_rastreio_pis.codigo_pi":"LIKE"}),vm.tableHeader=TableHeader.init("pis",vm),vm.rastreioHelper=RastreioHelper.init(vm),vm.load=function(){vm.loading=!0,Pi.pending({fields:["pedido_rastreio_pis.*"],filter:vm.filterList.parse(),page:vm.tableHeader.pagination.page,per_page:vm.tableHeader.pagination.per_page}).then(function(response){vm.tableData=response,vm.loading=!1})},vm.load()}angular.module("MeuTucano").controller("PiPendenteListController",PiPendenteListController)}();