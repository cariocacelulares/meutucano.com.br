!function(){"use strict";function o(o,e,a,t,n,r,s,i,l,c,u){var d=this;d.searchOpen=!1,d.user=a.currentUser,d.metas={},d.loadingMetas=!1,a.$on("upload",function(){d.loadMeta()}),a.$on("loading",function(){d.loadingMetas=!0}),a.$on("stop-loading",function(){d.loadingMetas=!1}),d.loadMeta=function(){d.loadingMetas=!0,l.one("metas/atual").customGET().then(function(o){d.metas=o,d.loadingMetas=!1})},d.loadMeta(),c(function(){d.loadMeta()},6e4),d.openSearch=function(){d.searchOpen=!0,t("searchInput")},a.$on("closeSearch",function(){d.searchOpen=!1}),d.logout=function(){o.logout().then(function(){localStorage.removeItem("user"),a.authenticated=!1,a.currentUser=null,e.go("login")})},d.printXML=function(o){var e={token:localStorage.getItem("satellizer_token")};r.open(n.read("apiUrl")+"/notas/xml/"+o+"?"+s(e),"xml")},d.printDanfe=function(o){var e={token:localStorage.getItem("satellizer_token")};r.open(n.read("apiUrl")+"/notas/danfe/"+o+"?"+s(e),"danfe")},d.printEtiqueta=function(o){var e={token:localStorage.getItem("satellizer_token")};r.open(n.read("apiUrl")+"/rastreios/etiqueta/"+o+"?"+s(e),"etiqueta")},d.pi=function(o){i.open({template:"views/atendimento/partials/pi.html",className:"ngdialog-theme-default ngdialog-big",controller:"PiController",controllerAs:"Pi",data:{rastreio:o}})},d.devolucao=function(o){i.open({template:"views/atendimento/partials/devolucao.html",className:"ngdialog-theme-default ngdialog-big",controller:"DevolucaoController",controllerAs:"Devolucao",data:{rastreio:o}})},d.logistica=function(o){i.open({template:"views/atendimento/partials/logistica.html",className:"ngdialog-theme-default ngdialog-big",controller:"LogisticaController",controllerAs:"Logistica",data:{rastreio:o}})},d.cancelar=function(o){l.one("pedidos",o).remove().then(function(){a.$broadcast("upload"),d.loadMeta(),u.pop("success","Sucesso!","Pedido deletado com sucesso!")})}}o.$inject=["$auth","$state","$rootScope","focus","envService","$window","$httpParamSerializer","ngDialog","Restangular","$interval","toaster"],angular.module("MeuTucano").controller("AppController",o)}(),function(){"use strict";function o(){}angular.module("MeuTucano").controller("DashboardController",o)}(),function(){"use strict";function o(o,e,a,t,n,r){var s=this;s.username=localStorage.getItem("lastUser"),n(s.username?"password":"username"),s.login=function(){s.loading=!0,localStorage.setItem("lastUser",s.username);var n={username:s.username,password:s.password};o.login(n).then(function(){return e.get(r.read("apiUrl")+"/authenticate/user")}).then(function(o){s.loading=!1;var e=JSON.stringify(o.data.user);localStorage.setItem("user",e),t.authenticated=!0,t.currentUser=o.data.user,a.go("app.dashboard")})}}o.$inject=["$auth","$http","$state","$rootScope","focus","envService"],angular.module("MeuTucano").controller("AuthController",o)}(),function(){"use strict";function o(o,e,a,t){var n=this;n.rastreio=angular.copy(a.ngDialogData.rastreio),n.devolucao={},n.fullSend=!1,n.rastreio.devolucao?(n.devolucao=n.rastreio.devolucao,n.fullSend=!0):n.devolucao={motivo_status:n.rastreio.status,rastreio_ref:{valor:n.rastreio.valor},pago_cliente:"0"},n.save=function(){o.one("devolucoes/edit",n.rastreio.id).customPUT(n.devolucao).then(function(){e.$broadcast("upload"),a.closeThisDialog(),t.pop("success","Sucesso!","Devolução criada com sucesso!")})}}o.$inject=["Restangular","$rootScope","$scope","toaster"],angular.module("MeuTucano").controller("DevolucaoController",o)}(),function(){"use strict";function o(o,e,a,t){var n=this;n.rastreio=angular.copy(a.ngDialogData.rastreio),n.cep=angular.copy(a.ngDialogData.rastreio.pedido.endereco.cep),n.save=function(){var r={rastreio:n.rastreio.rastreio,data_envio:n.rastreio.data_envio_readable,prazo:n.rastreio.prazo,cep:n.cep,status:n.rastreio.status};o.one("rastreios/edit",n.rastreio.id).customPUT(r).then(function(){e.$broadcast("upload"),a.closeThisDialog(),t.pop("success","Sucesso!","Pedido editado com sucesso!")})}}o.$inject=["Restangular","$rootScope","$scope","toaster"],angular.module("MeuTucano").controller("EditarController",o)}(),function(){"use strict";function o(o,e,a,t){var n=this;n.rastreio=angular.copy(a.ngDialogData.rastreio),n.logistica={},n.fullSend=!1,n.preSend=!1,n.rastreio.logistica&&(n.logistica=n.rastreio.logistica,n.logistica.acao?n.fullSend=!0:(n.preSend=!0,n.logistica.rastreio_ref={valor:n.rastreio.valor},console.log(n.logistica))),n.save=function(){o.one("logisticas/edit",n.rastreio.id).customPUT(n.logistica).then(function(){e.$broadcast("upload"),a.closeThisDialog(),t.pop("success","Sucesso!","Logística reversa criada com sucesso!")})}}o.$inject=["Restangular","$rootScope","$scope","toaster"],angular.module("MeuTucano").controller("LogisticaController",o)}(),function(){"use strict";function o(o,e,a,t){var n=this;n.observacao=a.ngDialogData.rastreio.observacao,n.save=function(){o.one("rastreios",a.ngDialogData.rastreio.id).customPUT({observacao:n.observacao}).then(function(){e.$broadcast("upload"),a.closeThisDialog(),t.pop("success","Sucesso!","Observação salva com sucesso!")})}}o.$inject=["Restangular","$rootScope","$scope","toaster"],angular.module("MeuTucano").controller("ObservacaoController",o)}(),function(){"use strict";function o(o,e,a,t,n,r){var s=this;s.rastreio=angular.copy(a.ngDialogData.rastreio),s.fullSend=!1,s.preSend=!1,s.rastreio.pi?(s.pi=s.rastreio.pi,s.pi.status?s.fullSend=!0:(s.preSend=!0,s.pi.rastreio_ref={valor:s.rastreio.valor},s.pi.pago_cliente="0")):s.pi={motivo_status:s.rastreio.status},s.save=function(){o.one("pis/edit",s.rastreio.id).customPUT(s.pi).then(function(){e.$broadcast("upload"),a.closeThisDialog(),t.pop("success","Sucesso!","Pedido de informação alterado com sucesso!")})},s.openPi=function(){var o={rastreio:s.rastreio.rastreio,nome:s.rastreio.pedido.cliente.nome,cep:s.rastreio.pedido.endereco.cep,endereco:s.rastreio.pedido.endereco.rua,numero:s.rastreio.pedido.endereco.numero,complemento:s.rastreio.pedido.endereco.complemento,bairro:s.rastreio.pedido.endereco.bairro,data:s.rastreio.data_envio_readable,tipo:s.rastreio.servico,status:3==s.rastreio.status?"e":"a"};n.open("http://www2.correios.com.br/sistemas/falecomoscorreios/?"+r(o))}}o.$inject=["Restangular","$rootScope","$scope","toaster","$window","$httpParamSerializer"],angular.module("MeuTucano").controller("PiController",o)}(),function(){"use strict";function o(o,e,a,t){var n=this;n.rastreios=[],n.loading=!1,o.$on("upload",function(){n.load()}),o.$on("loading",function(){n.loading=!0}),o.$on("stop-loading",function(){n.loading=!1}),n.load=function(){n.rastreios=[],n.loading=!0,e.all("rastreios").getList().then(function(o){n.rastreios=o,n.loading=!1})},n.load(),n.refreshAll=function(){n.rastreios=[],n.loading=!0,e.one("rastreios/refresh_all").customPUT().then(function(o){n.rastreios=o,n.loading=!1,t.pop("success","Sucesso!","Rastreios atualizados com sucesso!")})},n.observacao=function(o){a.open({template:"views/atendimento/partials/observacao.html",className:"ngdialog-theme-default",controller:"ObservacaoController",controllerAs:"Observacao",data:{rastreio:o}})},n.editar=function(o){a.open({template:"views/atendimento/partials/editar.html",className:"ngdialog-theme-default",controller:"EditarController",controllerAs:"Editar",data:{rastreio:o}})}}o.$inject=["$rootScope","Restangular","ngDialog","toaster"],angular.module("MeuTucano").controller("RastreioController",o)}(),function(){"use strict";function o(o){var e=this;e.senhas=[],e.loading=!1,e.load=function(){e.senhas=[],e.loading=!0,o.one("minhas-senhas").getList().then(function(o){e.senhas=o,e.loading=!1})},e.load()}o.$inject=["Restangular"],angular.module("MeuTucano").controller("MinhaSenhaController",o)}(),function(){"use strict";function o(o,e,a,t){var n=this;n.senha=angular.copy(a.ngDialogData.senha),n.save=function(){o.one("senhas",n.senha.id).customPUT(n.senha).then(function(){e.$broadcast("upload"),a.closeThisDialog(),t.pop("success","Sucesso!","Senha editada com sucesso!")})}}o.$inject=["Restangular","$rootScope","$scope","toaster"],angular.module("MeuTucano").controller("SenhaEditarController",o)}(),function(){"use strict";function o(o,e,a,t){var n=this;n.senha={},n.senha.usuario_id=a.ngDialogData.user_id,n.save=function(){o.one("senhas").customPOST(n.senha).then(function(){e.$broadcast("upload"),a.closeThisDialog(),t.pop("success","Sucesso!","Senha criada com sucesso!")})}}o.$inject=["Restangular","$rootScope","$scope","toaster"],angular.module("MeuTucano").controller("SenhaNovaController",o)}(),function(){"use strict";function o(o,e,a,t){var n=this;n.usuarios=[],n.loading=!1,o.$on("upload",function(){n.load()}),o.$on("loading",function(){n.loading=!0}),o.$on("stop-loading",function(){n.loading=!1}),n.load=function(){n.usuarios=[],n.loading=!0,e.all("usuarios").getList().then(function(o){n.usuarios=o,n.loading=!1})},n.load(),n.editar=function(o){a.open({template:"views/interno/partials/usuario_form.html",className:"ngdialog-theme-default",controller:"UsuarioEditarController",controllerAs:"Form",data:{usuario:o}})},n.create=function(){a.open({template:"views/interno/partials/usuario_form.html",className:"ngdialog-theme-default",controller:"UsuarioNovoController",controllerAs:"Form"})},n.destroy=function(a){e.one("usuarios",a).customDELETE().then(function(){o.$broadcast("upload"),t.pop("success","Sucesso!","Usuário deletado com sucesso!")})}}o.$inject=["$rootScope","Restangular","ngDialog","toaster"],angular.module("MeuTucano").controller("UsuarioController",o)}(),function(){"use strict";function o(o,e,a,t){var n=this;n.usuario=angular.copy(a.ngDialogData.usuario),n.usuario.novasRoles=[],angular.forEach(n.usuario.roles,function(o){n.usuario.novasRoles[o.id]=o.id}),n.save=function(){o.one("usuarios",n.usuario.id).customPUT(n.usuario).then(function(){e.$broadcast("upload"),a.closeThisDialog(),t.pop("success","Sucesso!","Usuário editado com sucesso!")})}}o.$inject=["Restangular","$rootScope","$scope","toaster"],angular.module("MeuTucano").controller("UsuarioEditarController",o)}(),function(){"use strict";function o(o,e,a,t){var n=this;n.usuario={},n.save=function(){o.one("usuarios").customPOST(n.usuario).then(function(){e.$broadcast("upload"),a.closeThisDialog(),t.pop("success","Sucesso!","Usuário criado com sucesso!")})}}o.$inject=["Restangular","$rootScope","$scope","toaster"],angular.module("MeuTucano").controller("UsuarioNovoController",o)}(),function(){"use strict";function o(o,e,a,t,n){var r=this;r.senhas=[],r.loading=!1,r.user_id=e.id,o.$on("upload",function(){r.load()}),o.$on("loading",function(){r.loading=!0}),o.$on("stop-loading",function(){r.loading=!1}),r.load=function(){r.senhas=[],r.loading=!0,a.one("senhas/usuario",r.user_id).getList().then(function(o){r.senhas=o,r.loading=!1})},r.load(),r.editar=function(o){t.open({template:"views/interno/partials/senha_form.html",className:"ngdialog-theme-default",controller:"SenhaEditarController",controllerAs:"Form",data:{senha:o}})},r.create=function(){t.open({template:"views/interno/partials/senha_form.html",className:"ngdialog-theme-default",controller:"SenhaNovaController",controllerAs:"Form",data:{user_id:r.user_id}})},r.destroy=function(e){a.one("senhas",e).customDELETE().then(function(){o.$broadcast("upload"),n.pop("success","Sucesso!","Senha deletada com sucesso!")})}}o.$inject=["$rootScope","$stateParams","Restangular","ngDialog","toaster"],angular.module("MeuTucano").controller("UsuarioSenhaController",o)}(),function(){"use strict";function o(o,e,a){var t=this;t.notas=[],t.codigo={servico:"0"},t.loading=!1,t.generating=!1,o.$on("upload",function(){t.load()}),o.$on("loading",function(){t.loading=!0}),o.$on("stop-loading",function(){t.loading=!1}),t.load=function(){t.notas=[],t.loading=!0,e.all("notas/faturamento").getList().then(function(o){t.notas=o,t.loading=!1})},t.load(),t.generateCode=function(){t.codigo.rastreio="Gerando...",e.one("codigos/gerar",t.codigo.servico).customGET().then(function(o){t.codigo.rastreio=o.codigo,o.hasOwnProperty("error")&&(t.codigo.rastreio="Códigos esgotados!",a.pop("error","Erro",o.error)),o.hasOwnProperty("msg")&&a.pop("warning","Atenção",o.msg),t.codigo.mensagem=o.msg})}}o.$inject=["$rootScope","Restangular","toaster"],angular.module("MeuTucano").controller("FaturamentoController",o)}(),function(){"use strict";function o(o){var e=this;e.openSub=function(o){angular.forEach(e.items,function(e){e!=o&&(e.subOpen=!1)}),o.subOpen=!o.subOpen},e.openInf=function(o,e){angular.forEach(o.sub,function(o){o!=e&&(o.subOpen=!1)}),e.subOpen=!e.subOpen},e.items=[{title:"Painel",sref:o.href("app.dashboard"),icon:"fa-dashboard"},{title:"Atendimento",icon:"fa-user-md",roles:["admin","atendimento"],sub:[{title:"Rastreio",icon:"fa-truck",sref:o.href("app.atendimento.rastreio")}]},{title:"Faturamento",icon:"fa-barcode",roles:["admin","faturamento"],sref:o.href("app.faturamento.notas")},{title:"Interno",icon:"fa-desktop",sub:[{title:"Usuários",icon:"fa-users",sref:o.href("app.interno.usuarios"),roles:["admin"]},{title:"Minhas senhas",icon:"fa-key",sref:o.href("app.interno.senhas.minhas")}]}]}o.$inject=["$state"],angular.module("MeuTucano").controller("MenuController",o)}(),function(){"use strict";function o(o,e){var a=this;a.search="",a.resultadoBusca={},a.buscaLoading=!1,e.$on("upload",function(){a.load()}),e.$on("loading",function(){a.buscaLoading=!0}),e.$on("stop-loading",function(){a.buscaLoading=!1}),a.close=function(){e.$broadcast("closeSearch")},a.load=function(){a.search.length<=3?a.resultadoBusca={}:(a.buscaLoading=!0,o.all("search").customGET("",{search:a.search}).then(function(o){a.buscaLoading=!1,a.resultadoBusca=o}))}}o.$inject=["Restangular","$rootScope"],angular.module("MeuTucano").controller("SearchController",o).filter("highlight",["$sce",function(o){return function(e,a){return a&&(e=String(e).replace(new RegExp("("+a+")","gi"),'<span class="underline">$1</span>')),o.trustAsHtml(e)}}])}(),function(){"use strict";function o(o,e,a,t){var n=this;n.upload=function(n){n&&n.length&&(t.$broadcast("loading"),o.upload({url:a.read("apiUrl")+"/upload",headers:{Authorization:"Bearer "+localStorage.getItem("satellizer_token")},data:{arquivos:n}}).success(function(o){t.$broadcast("upload"),t.$broadcast("stop-loading"),e.pop("success","Upload concluído",o.data.msg)}).error(function(){e.pop("error","Erro no upload!","Erro ao enviar arquivos, tente novamente!")}))}}o.$inject=["Upload","toaster","envService","$rootScope"],angular.module("MeuTucano").controller("UploadController",o)}();